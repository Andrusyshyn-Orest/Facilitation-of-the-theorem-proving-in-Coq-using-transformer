{
    "filename": "Monotonicity.v",
    "coq_project": "coqrel",
    "vernac_cmds": [
        [
            "Require Export RelDefinitions.",
            "VernacRequire",
            "036c68d68a856450b36b1b4547347d362f79906e"
        ],
        [
            "Require Export RelOperators.",
            "VernacRequire",
            "3101f0b0bb0a0847cc301a6f297b848e016f14fc"
        ],
        [
            "Require Export Relators.",
            "VernacRequire",
            "b1c325d28be9657bb2dc62c0003e74aeaf2f6ca8"
        ],
        [
            "Require Import Delay.",
            "VernacRequire",
            "963113fe690d279de81b77926a6721a1f767f0f6"
        ],
        [
            "Class QueryParams {A B} (m1: A) (m2: B) (n: nat).",
            "VernacInductive",
            "a28acb86ac71480a0f6cbec545d8650991add7fd"
        ],
        [
            "Lemma query_params_one {A B C} (h: A) p (m1: B) (m2: C) n: Params h (p + n) -> QueryParams m1 m2 n.",
            "VernacStartTheoremProof",
            "76f58df8a43425588d69253ec09e37f01607e6e3"
        ],
        [
            "constructor.",
            "VernacExtend",
            "3c77e6be855b5086df5e918bf2a0537e1010479a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Lemma query_params_both {A B C D} (h1: A) (h2: B) p1 p2 (m1: C) (m2: D) n: Params h1 (p1 + n) -> Params h2 (p2 + n) -> QueryParams m1 m2 n.",
            "VernacStartTheoremProof",
            "3337d38cdcfff5f8f7af6eb63a3786f4e5622af5"
        ],
        [
            "constructor.",
            "VernacExtend",
            "3c77e6be855b5086df5e918bf2a0537e1010479a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Ltac count_unapplied_params m := let rec count t := lazymatch t with | forall x, ?t' => let n := count t' in constr:(S n) | _ => constr:(O) end in let t := type of m in let t := eval cbv in t in count t.",
            "VernacExtend",
            "31d9f43d0de775ff50553f1cd57abf132dd7dd29"
        ],
        [
            "Ltac query_params m1 m2 := let rec head t := lazymatch t with ?t' _ => head t' | _ => t end in let h1 := head m1 in let p1 := count_unapplied_params m1 in let h2 := head m2 in let p2 := count_unapplied_params m2 in first [ not_evar h1; not_evar h2; eapply (query_params_both h1 h2 p1 p2) | not_evar h1; is_evar h2; eapply (query_params_one h1 p1) | is_evar h1; not_evar h2; eapply (query_params_one h2 p2) ].",
            "VernacExtend",
            "86664d4743037a5e385ea1a503a63075c0edaa87"
        ],
        [
            "Hint Extern 10 (QueryParams ?m1 ?m2 _) => query_params m1 m2 : typeclass_instances.",
            "VernacHints",
            "4a6eb7eb6b0dce3f69454495823dbe2b87ca90a1"
        ],
        [
            "Ltac pass_evar_to k := let Av := fresh \"A\" in evar (Av : Type); let A := eval red in Av in clear Av; let av := fresh \"a\" in evar (av : A); let a := eval red in av in clear av; k a.",
            "VernacExtend",
            "59099f804ba94e31d7401b52757a21d515be5ea4"
        ],
        [
            "Class RemoveParams {A B C D} (n: nat) (m1: A) (m2: B) (f: C) (g: D).",
            "VernacInductive",
            "ca150f3360537858a2722d765a0a37b24ae93cc5"
        ],
        [
            "Ltac remove_params_from n m k := lazymatch n with | O => k m | S ?n' => lazymatch m with | ?m' _ => remove_params_from n' m' k | _ => is_evar m; pass_evar_to k end end.",
            "VernacExtend",
            "e63a7a6c2addd6af4b9deafaeeb3f19615287d6c"
        ],
        [
            "Ltac remove_params n m1 m2 f g := remove_params_from n m1 ltac:(fun m1' => unify f m1'; remove_params_from n m2 ltac:(fun m2' => unify g m2')).",
            "VernacExtend",
            "830deec6d4e459dd3c2edcba7abf4e0a404f8135"
        ],
        [
            "Hint Extern 1 (RemoveParams ?n ?m1 ?m2 ?f ?g) => remove_params n m1 m2 f g; constructor : typeclass_instances.",
            "VernacHints",
            "7d6ff129742b18f30d14f90eee92d31f98758721"
        ],
        [
            "Class RemoveAllParams {A B C D} (m1: A) (m2: B) (f: C) (g: D).",
            "VernacInductive",
            "0922b70d79c434e8e1784584ef57601399c0356c"
        ],
        [
            "Ltac remove_all_params_from m k := lazymatch m with | ?m' _ => remove_all_params_from m' k | _ => not_evar m; k m end.",
            "VernacExtend",
            "495c528077bf6b9c95577e93a6c526597a7dc1aa"
        ],
        [
            "Ltac remove_all_params m1 m2 f g := first [ is_evar m2; remove_all_params_from m1 ltac:(fun m1' => unify f m1'; pass_evar_to ltac:(fun m2' => unify g m2')) | is_evar m1; remove_all_params_from m2 ltac:(fun m2' => unify g m2'; pass_evar_to ltac:(fun m1' => unify f m1')) | lazymatch m1 with ?m1' _ => lazymatch m2 with ?m2' _ => remove_all_params m1' m2' f g end end | not_evar m1; unify f m1; not_evar m2; unify g m2 ].",
            "VernacExtend",
            "e076cb5fdcd5f23cce02ca6917c713a5148841c2"
        ],
        [
            "Hint Extern 1 (RemoveAllParams ?m1 ?m2 ?f ?g) => remove_all_params m1 m2 f g; constructor : typeclass_instances.",
            "VernacHints",
            "c780e00b83fc48d48c9a7b985647b7c7f2429cc0"
        ],
        [
            "Class CandidateProperty {A B} (R': rel A B) f g (Q: Prop) := candidate_related: R' f g.",
            "VernacInductive",
            "98bfb8d0323817b4cd058e9de5ed6b03b0fe4c43"
        ],
        [
            "Instance as_is_candidate {A B} (R R': rel A B) m1 m2: Related m1 m2 R' -> CandidateProperty R' m1 m2 (R m1 m2) | 10.",
            "VernacInstance",
            "f4e22127e98921e0bd95133945d3c2807b9d251f"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Instance remove_params_candidate {A B C D} R (m1: A) (m2: B) R' (f: C) (g: D) n: QueryParams m1 m2 n -> RemoveParams n m1 m2 f g -> Related f g R' -> CandidateProperty R' f g (R m1 m2) | 20.",
            "VernacInstance",
            "ec75260b278ec18ba746e4913f813f406ba91bde"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Instance remove_all_params_candidate {A B C D} R (m1:A) (m2:B) R' (f:C) (g:D): RemoveAllParams m1 m2 f g -> Related f g R' -> CandidateProperty R' f g (R m1 m2) | 30.",
            "VernacInstance",
            "e3aa7d7af59ee945167413c4f2d2e2430296c991"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Lemma flip_context_candidate {A B} (R: rel A B) x y : R y x -> flip R x y.",
            "VernacStartTheoremProof",
            "42fb1b0aaa5480dbca54d7944ce928fa1d58b280"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Ltac context_candidate := let rec is_prefix f m := first [ unify f m | lazymatch m with ?n _ => is_prefix f n end ] in let rec is_prefixable f m := first [ is_evar f | is_evar m | unify f m | lazymatch m with ?n _ => is_prefixable f n end ] in multimatch goal with | H: _ ?f ?g |- @CandidateProperty ?A ?B ?R ?x ?y (_ ?m ?n) => red; once first [ is_prefix f m; is_prefixable g n | is_prefix g n; is_prefixable f m | is_prefix g m; is_prefixable f n; apply flip_context_candidate | is_prefix f n; is_prefixable g m; apply flip_context_candidate ]; eexact H end.",
            "VernacExtend",
            "03d3c579bba909d1e64edaa977217b6fc59fb15e"
        ],
        [
            "Hint Extern 1 (CandidateProperty _ _ _ _) => context_candidate : typeclass_instances.",
            "VernacHints",
            "7a397b4ae2f6e4da11819023f035624fec266b3c"
        ],
        [
            "Class RImpl (P Q: Prop): Prop := rimpl: P -> Q.",
            "VernacInductive",
            "d125f7571270a0e0ed308b70070695b445568d51"
        ],
        [
            "Global Instance rimpl_refl {A B} (R : rel A B) m n: RImpl (R m n) (R m n).",
            "VernacInstance",
            "a9f67fcce0cf348d6e6fc53fb08930375f026d25"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Global Instance rimpl_subrel {A B} (R R': rel A B) m n: NonDelayed (RAuto (subrel R R')) -> RImpl (R m n) (R' m n).",
            "VernacInstance",
            "911ff0da52e20bae2fae4821641402a2053a62ef"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Global Instance rimpl_flip_subrel {A B} R R' (x: A) (y: B): NonDelayed (RAuto (subrel R (flip R'))) -> RImpl (R x y) (R' y x) | 2.",
            "VernacInstance",
            "a599178654faf19012ca4d2878508ff696c113cb"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Class Monotonicity (P Q: Prop): Prop := monotonicity: P -> Q.",
            "VernacInductive",
            "c5c2b9fd3eec70e4d0a4797d71941989e01f3125"
        ],
        [
            "Global Instance apply_candidate {A B} (R: rel A B) m n P Q Q': CandidateProperty R m n Q -> RElim R m n P Q' -> RImpl Q' Q -> Monotonicity P Q.",
            "VernacInstance",
            "d9f77ec281c9d5ccf5c120ada0b75070bcb1c30c"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Ltac monotonicity := lazymatch goal with |- ?Q => apply (monotonicity (Q:=Q)) end; Delay.split_conjunction.",
            "VernacExtend",
            "037a69395a2dcf599ad8e73377c72469fbab1d48"
        ],
        [
            "Global Instance monotonicity_rstep {A B} (P: Prop) (R: rel A B) m n: Monotonicity P (R m n) -> RStep P (R m n) | 50.",
            "VernacInstance",
            "30461a970c73f4a48580ec7de0093be73c73bc78"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Class SubrelMonotonicity (P Q: Prop): Prop := subrel_monotonicity: P -> Q.",
            "VernacInductive",
            "6080ef9fc2de97cb75b1c13c3c7b663e6895483b"
        ],
        [
            "Global Instance apply_candidate_subrel {A B C D} (R: rel A B) m n P Rc Rg x y: CandidateProperty R m n (Rg x y) -> RElim R m n P (Rc x y) -> SubrelMonotonicity (@subrel C D Rc Rg /\\ P) (Rg x y).",
            "VernacInstance",
            "ace1f3f63e58eb730ab40349a019fb64b3fbd7fb"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Ltac subrel_monotonicity := lazymatch goal with |- ?Q => apply (subrel_monotonicity (Q:=Q)) end; Delay.split_conjunction.",
            "VernacExtend",
            "431ffc7dbd3bc5195d0db1a7e90e26e9f50f4af9"
        ],
        [
            "Class CommonPrefix {A B C} (m1: A) (m2: B) (f: C).",
            "VernacInductive",
            "e503e347c9cb068487e50494f6cf5a69604c0cc2"
        ],
        [
            "Ltac common_prefix m1 m2 f := first [ not_evar m1; not_evar m2; unify m1 m2; unify f m1 | lazymatch m1 with ?m1' _ => lazymatch m2 with ?m2' _ => common_prefix m1' m2' f end end | unify m1 m2; unify f m1 ].",
            "VernacExtend",
            "4eff80c43bc7088fbc28a701a2dfbfe734b6d767"
        ],
        [
            "Hint Extern 1 (CommonPrefix ?m1 ?m2 ?f) => common_prefix m1 m2 f; constructor : typeclass_instances.",
            "VernacHints",
            "f3019d8b7232a9a8e913293f714344a2b1b06eb6"
        ],
        [
            "Global Instance eq_candidate {A B C} R (m1: A) (m2: B) (f: C): CommonPrefix m1 m2 f -> CandidateProperty eq f f (R m1 m2) | 100.",
            "VernacInstance",
            "1d4363ec3e16f5362df3448a1139d4db3b3e7502"
        ],
        [
            "firstorder.",
            "VernacExtend",
            "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Lemma f_equal_relim {A B} f g m n P Q: RElim eq (f m) (g n) P Q -> RElim (@eq (A -> B)) f g (m = n /\\ P) Q.",
            "VernacStartTheoremProof",
            "61420c25a409008cd3d5eea244cfca6c57894b9e"
        ],
        [
            "intros Helim Hf [Hmn HP].",
            "VernacExtend",
            "26a3e91ae75261040bf8b842a9e5663f97934c93"
        ],
        [
            "apply Helim; eauto.",
            "VernacExtend",
            "788408c0ba4c81f794105c05949e30f6177938f1"
        ],
        [
            "congruence.",
            "VernacExtend",
            "d8c818f6cffeaee6a722a71acc77f2d6e5199eb9"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ]
    ],
    "proofs": [
        {
            "name": "query_params_one",
            "line_nb": 5,
            "steps": [
                {
                    "command": [
                        "constructor.",
                        "VernacExtend",
                        "3c77e6be855b5086df5e918bf2a0537e1010479a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "query_params_both",
            "line_nb": 8,
            "steps": [
                {
                    "command": [
                        "constructor.",
                        "VernacExtend",
                        "3c77e6be855b5086df5e918bf2a0537e1010479a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "as_is_candidate",
            "line_nb": 24,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "remove_params_candidate",
            "line_nb": 27,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "remove_all_params_candidate",
            "line_nb": 30,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "flip_context_candidate",
            "line_nb": 33,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "rimpl_refl",
            "line_nb": 39,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "rimpl_subrel",
            "line_nb": 42,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "rimpl_flip_subrel",
            "line_nb": 45,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "apply_candidate",
            "line_nb": 49,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "monotonicity_rstep",
            "line_nb": 53,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "apply_candidate_subrel",
            "line_nb": 57,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "eq_candidate",
            "line_nb": 64,
            "steps": [
                {
                    "command": [
                        "firstorder.",
                        "VernacExtend",
                        "ceb9f57e98a5f5a73ee421cf30fd2f4f09432d14"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "f_equal_relim",
            "line_nb": 67,
            "steps": [
                {
                    "command": [
                        "intros Helim Hf [Hmn HP].",
                        "VernacExtend",
                        "26a3e91ae75261040bf8b842a9e5663f97934c93"
                    ]
                },
                {
                    "command": [
                        "apply Helim; eauto.",
                        "VernacExtend",
                        "788408c0ba4c81f794105c05949e30f6177938f1"
                    ]
                },
                {
                    "command": [
                        "congruence.",
                        "VernacExtend",
                        "d8c818f6cffeaee6a722a71acc77f2d6e5199eb9"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        }
    ]
}