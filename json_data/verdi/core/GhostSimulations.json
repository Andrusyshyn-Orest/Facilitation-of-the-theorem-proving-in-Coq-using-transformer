{
    "filename": "core/GhostSimulations.v",
    "coq_project": "verdi",
    "vernac_cmds": [
        [
            "Require Import List.",
            "VernacRequire",
            "d9bcce4a390afeb160107bf87c6f7abe3d82c6d6"
        ],
        [
            "Require Import StructTact.StructTactics.",
            "VernacRequire",
            "38f6d2cc08bbb87183850d39d33eebaeff475956"
        ],
        [
            "Require Import Verdi.Net.",
            "VernacRequire",
            "1e55512999c79155a01ce992b8e8117ae42773b0"
        ],
        [
            "Require Import StructTact.Util.",
            "VernacRequire",
            "422cb477e2dbeb3e15db67d22ebbc58c5621b5a7"
        ],
        [
            "Require Import FunctionalExtensionality.",
            "VernacRequire",
            "bb1bf6a28f9de1b2ad0dab7920189198216ed486"
        ],
        [
            "Require Import Verdi.TotalMapSimulations.",
            "VernacRequire",
            "8ef10761851cb174317b4da419a0461e34ef547e"
        ],
        [
            "Require Import Verdi.Ssrexport.",
            "VernacRequire",
            "221bef907661c3c9339fdc5a21b1a546e6646096"
        ],
        [
            "Set Implicit Arguments.",
            "VernacSetOption",
            "9e84ff8896f028601d8aded48c1d4aebe60aa584"
        ],
        [
            "Class GhostMultiParams `(P : MultiParams) := { ghost_data : Type; ghost_init : ghost_data ; ghost_net_handlers : name -> name -> msg -> (ghost_data * data) -> ghost_data; ghost_input_handlers : name -> input -> (ghost_data * data) -> ghost_data }.",
            "VernacInductive",
            "89b962ca9cbb9118df139f9c399dbac6703043bd"
        ],
        [
            "Section GhostVars.",
            "VernacBeginSection",
            "4b0f87f09c14fa6bdd23b85dc83a3736655a794b"
        ],
        [
            "Context {base_params : BaseParams}.",
            "VernacContext",
            "58f95a95a12107d09c64aae51a6b1211d4c9e638"
        ],
        [
            "Context {multi_params : MultiParams base_params}.",
            "VernacContext",
            "3ae75177157bf41af529f0c2e4775e8d4d4b9bbd"
        ],
        [
            "Context {failure_params : FailureParams multi_params}.",
            "VernacContext",
            "6eded612e8273e2acc9d15ff2e2c492537f06abd"
        ],
        [
            "Context {ghost_params : GhostMultiParams multi_params}.",
            "VernacContext",
            "c3c1ed732cab861151f1970c5ced3080d0e2c83f"
        ],
        [
            "Definition refined_net_handlers me src m st := let '(out, st', ps) := net_handlers me src m (snd st) in (out, (ghost_net_handlers me src m st, st'), ps).",
            "VernacDefinition",
            "5d8a3151e090389fc70e42b543a5c632ed50ea9e"
        ],
        [
            "Definition refined_input_handlers me inp st := let '(out, st', ps) := input_handlers me inp (snd st) in (out, (ghost_input_handlers me inp st, st'), ps).",
            "VernacDefinition",
            "d553364c585cd8b12be5ccb0142001dcaca02905"
        ],
        [
            "Definition refined_init_handlers (n : name) : ghost_data * data := (ghost_init, init_handlers n).",
            "VernacDefinition",
            "5925127462a6941514d8245316d78be6b3b46894"
        ],
        [
            "Definition refined_reboot (st : ghost_data * data) := (fst st , reboot (snd st)).",
            "VernacDefinition",
            "02f26833d4b90b241df3aa7e7bcb975b0980a0a6"
        ],
        [
            "Instance refined_base_params : BaseParams := { data := (ghost_data * data)%type ; input := input ; output := output }.",
            "VernacInstance",
            "5f2d8fcdbe7782eed0cf9658ad87219596ea2fbe"
        ],
        [
            "Instance refined_multi_params : MultiParams _ := { name := name ; msg := msg ; msg_eq_dec := msg_eq_dec ; name_eq_dec := name_eq_dec ; nodes := nodes ; all_names_nodes := all_names_nodes ; no_dup_nodes := no_dup_nodes ; init_handlers := refined_init_handlers; net_handlers := refined_net_handlers ; input_handlers := refined_input_handlers }.",
            "VernacInstance",
            "0682dd82b52058a397c76033249a85369cce1273"
        ],
        [
            "Instance refined_failure_params : FailureParams _ := { reboot := refined_reboot }.",
            "VernacInstance",
            "8d57e3722a63eb875b165d03e2570a699189ae90"
        ],
        [
            "Definition deghost_packet p := @mkPacket _ multi_params (@pSrc _ refined_multi_params p) (pDst p) (pBody p).",
            "VernacDefinition",
            "30d161f027669c10b9496cb1e92a047b733c655d"
        ],
        [
            "Definition deghost (net : @network _ refined_multi_params) : (@network _ multi_params).",
            "VernacDefinition",
            "feb3725253317bdafea45f3a71daa4de54951940"
        ],
        [
            "refine (@mkNetwork _ multi_params (map deghost_packet (nwPackets net)) _ ).",
            "VernacExtend",
            "03b8bd7973ad20d278d6d7a0043d0b681bfa7ca0"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "destruct net.",
            "VernacExtend",
            "3ead3c66b419e18eef776a8c646159f3625c20a0"
        ],
        [
            "concludes.",
            "VernacExtend",
            "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
        ],
        [
            "destruct nwState.",
            "VernacExtend",
            "8e8beae30b1475d5dc45fa891ca81cca7d5a69a8"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "Defined.",
            "VernacEndProof",
            "88c0be54a50df4bb90276c075406fe442428eb9c"
        ],
        [
            "Arguments deghost_packet /_.",
            "VernacArguments",
            "325c1bdec72cef70b7c48c609568952b3138d338"
        ],
        [
            "Definition deghost_prop I (failed_net : list name * network) : Prop := I ((fst failed_net), deghost (snd failed_net)).",
            "VernacDefinition",
            "04fdad186bd0513cd6d7268d50fed6830a55ca53"
        ],
        [
            "Instance refined_base_params_tot_map : BaseParamsTotalMap refined_base_params base_params := { tot_map_data := snd ; tot_map_input := id ; tot_map_output := id }.",
            "VernacInstance",
            "2f85447ff40616c181e6976ecace545164c04271"
        ],
        [
            "Instance refined_multi_params_name_tot_map : MultiParamsNameTotalMap refined_multi_params multi_params := { tot_map_name := id ; tot_map_name_inv := id }.",
            "VernacInstance",
            "765b13c0ae1dfad4e0e03d20feac720efb50bcf6"
        ],
        [
            "Instance refined_multi_params_name_tot_map_bijective : MultiParamsNameTotalMapBijective refined_multi_params_name_tot_map := { tot_map_name_inv_inverse := fun _ => eq_refl ; tot_map_name_inverse_inv := fun _ => eq_refl }.",
            "VernacInstance",
            "e539869c5636fab7094de4da01632b4c654670cb"
        ],
        [
            "Instance refined_multi_params_tot_msg_map : MultiParamsMsgTotalMap refined_multi_params multi_params := { tot_map_msg := id }.",
            "VernacInstance",
            "c5695d7fcae21154c17bcffc93614a1b7d51663b"
        ],
        [
            "Program Instance refined_multi_params_map_congruency : MultiParamsTotalMapCongruency refined_base_params_tot_map refined_multi_params_name_tot_map refined_multi_params_tot_msg_map := { tot_init_handlers_eq := fun _ => eq_refl ; tot_net_handlers_eq := _ ; tot_input_handlers_eq := _ }.",
            "VernacInstance",
            "597233def62be7f23aafa2949a4925955e7fffcb"
        ],
        [
            "Next Obligation.",
            "VernacExtend",
            "de5e6a0a7a163af0d8463969c3ff4241d7d5bba0"
        ],
        [
            "rewrite /tot_mapped_net_handlers /= /refined_net_handlers /= /tot_map_name_msgs /= /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "repeat break_let.",
            "VernacExtend",
            "af4c4045b2a41d256b959f44ffccc9ee0df74742"
        ],
        [
            "find_inversion.",
            "VernacExtend",
            "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
        ],
        [
            "by rewrite /= -/id map_id map_fst_snd_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Next Obligation.",
            "VernacExtend",
            "de5e6a0a7a163af0d8463969c3ff4241d7d5bba0"
        ],
        [
            "rewrite /tot_mapped_input_handlers /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "repeat break_let.",
            "VernacExtend",
            "af4c4045b2a41d256b959f44ffccc9ee0df74742"
        ],
        [
            "unfold refined_input_handlers in *.",
            "VernacExtend",
            "37932c13c6043c6d3194fd622107e0c3e55a1de5"
        ],
        [
            "repeat break_let.",
            "VernacExtend",
            "af4c4045b2a41d256b959f44ffccc9ee0df74742"
        ],
        [
            "find_inversion.",
            "VernacExtend",
            "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
        ],
        [
            "by rewrite /id /= map_id /tot_map_name_msgs /= /id /= map_fst_snd_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Instance refined_failure_params_map_congruency : FailureParamsTotalMapCongruency refined_failure_params failure_params refined_base_params_tot_map := { tot_reboot_eq := fun _ => eq_refl }.",
            "VernacInstance",
            "4da0589a117455f6e6bba798883c47d3e8f1ce2d"
        ],
        [
            "Lemma map_id_tr : forall out, map (fun e : name * (input + list output) => let (n, s) := e in match s with | inl io => (n, inl io) | inr lo => (n, inr (map id lo)) end) out = out.",
            "VernacStartTheoremProof",
            "efd3aba084315c5513b77c82c3cd660a044c4ddd"
        ],
        [
            "elim => //.",
            "VernacExtend",
            "e686a1895f1799b840b76242f931100819a9ad6c"
        ],
        [
            "move => tr l IH.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "rewrite /= IH.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "break_let.",
            "VernacExtend",
            "0d8806c04d7bd574741dfa032ad14204e251f21e"
        ],
        [
            "break_match => //=.",
            "VernacExtend",
            "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
        ],
        [
            "by rewrite map_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem ghost_simulation_1 : forall net net' failed failed' out, @step_failure _ _ refined_failure_params (failed, net) (failed', net') out -> @step_failure _ _ failure_params (failed, deghost net) (failed', deghost net') out.",
            "VernacStartTheoremProof",
            "330e94ee85459b14045afcd4cea496ca4eea294e"
        ],
        [
            "move => net net' failed failed' out H_step.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "apply step_failure_tot_mapped_simulation_1 in H_step.",
            "VernacExtend",
            "60293bc0c8ca467960d69b34cf754929db8283af"
        ],
        [
            "rewrite /tot_map_name /tot_map_net /= 2!map_id /id /= in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /tot_map_trace_occ /= /id /= in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /tot_map_packet /= /id /= in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /deghost /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite -/id map_id_tr in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "move: H_step.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "set fp := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fp' := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq: fp = fp' by rewrite /fp /fp'; apply functional_extensionality; case => /= src dst m.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "rewrite H_eq {H_eq fp}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "set fs1 := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fs2 := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fs1' := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fs2' := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq: fs1 = fs1' by rewrite /fs1 /fs1' {fs1 fs1'}; apply functional_extensionality => n; case: net.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "rewrite H_eq {H_eq fs1}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "have H_eq: fs2 = fs2' by rewrite /fs2 /fs2' {fs2 fs2'}; apply functional_extensionality => n; case: net'.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "by rewrite H_eq {H_eq fs2}.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem ghost_simulation_2 : forall net net' failed failed' out gnet, @step_failure _ _ failure_params (failed, net) (failed', net') out -> deghost gnet = net -> exists gnet', step_failure (failed, gnet) (failed', gnet') out /\\ deghost gnet' = net'.",
            "VernacStartTheoremProof",
            "c0ce23b81355b745fbb227352970d02f85555947"
        ],
        [
            "move => net net' failed failed' out gnet H_step H_eq.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "eapply step_failure_tot_mapped_simulation_2 in H_step => //.",
            "VernacExtend",
            "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "move: H_step => [gnet' [H_step H_eq_net]].",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "exists gnet'.",
            "VernacExtend",
            "60ddeadc3c41d3290258ab35cd0f179e963a1e4c"
        ],
        [
            "split; eauto.",
            "VernacExtend",
            "f3520b20a884376c5c10e2f9e716eedc86a566b6"
        ],
        [
            "rewrite -H_eq_net {H_eq_net H_step}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /deghost /tot_map_net /= /id /= /tot_map_packet /= /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "set nwPf1 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwPf2 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_p: nwPf1 = nwPf2 by rewrite /nwPf1 /nwPf2 {nwPf1 nwPf2}; apply functional_extensionality; case.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "set nwS1 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwS2 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_s: nwS1 = nwS2 by rewrite /nwS1 /nwS2 {nwS1 nwS2}; apply functional_extensionality => n; case: gnet'.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "by rewrite H_eq_p H_eq_s.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "rewrite -H_eq {H_step H_eq}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /deghost /tot_map_net /= /id /= /tot_map_packet /= /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "set nwPf1 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwPf2 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_p: nwPf1 = nwPf2 by rewrite /nwPf1 /nwPf2 {nwPf1 nwPf2}; apply functional_extensionality; case.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "set nwS1 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwS2 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_s: nwS1 = nwS2 by rewrite /nwS1 /nwS2 {nwS1 nwS2}; apply functional_extensionality => n; case: gnet.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "by rewrite H_eq_p H_eq_s.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "by rewrite /tot_map_name /= map_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "by rewrite /tot_map_name /= map_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "move {H_step}.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "elim: out => //.",
            "VernacExtend",
            "e686a1895f1799b840b76242f931100819a9ad6c"
        ],
        [
            "case => n t out IH.",
            "VernacExtend",
            "e00fff71ff314c991514fc71c41a3556702e444a"
        ],
        [
            "case: t => /=; first by move => inp; rewrite /id /= IH.",
            "VernacExtend",
            "3763a4b8db689af316a7372b722bb29806ab4fb6"
        ],
        [
            "move => out'.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "by rewrite {1}/id map_id /= IH.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Definition ghost_packet p := @mkPacket _ refined_multi_params (@pSrc _ multi_params p) (pDst p) (pBody p).",
            "VernacDefinition",
            "04412c9ef7fb670259d3b4e06fa5d59ba91553dc"
        ],
        [
            "Definition reghost (net : @network _ multi_params) : @network _ refined_multi_params.",
            "VernacDefinition",
            "2f6f33114647d77f71db4ee7cb0fa122204161d0"
        ],
        [
            "refine (@mkNetwork _ refined_multi_params (map ghost_packet (nwPackets net)) _ ).",
            "VernacExtend",
            "f348ec7203f178df221f53ea88a17befa29bcfea"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "destruct net.",
            "VernacExtend",
            "3ead3c66b419e18eef776a8c646159f3625c20a0"
        ],
        [
            "concludes.",
            "VernacExtend",
            "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
        ],
        [
            "exact (ghost_init, nwState).",
            "VernacExtend",
            "68f4ff83d45c00d1574178c93c1e902bb2baa408"
        ],
        [
            "Defined.",
            "VernacEndProof",
            "88c0be54a50df4bb90276c075406fe442428eb9c"
        ],
        [
            "Arguments ghost_packet /_.",
            "VernacArguments",
            "b35d8e4883656f99fe5512d846000e38660fb658"
        ],
        [
            "Lemma reghost_deghost_partial_inverses : forall net, deghost (reghost net) = net.",
            "VernacStartTheoremProof",
            "8352a5a9bb0d25d0ec644e5b0776d53d7778a21c"
        ],
        [
            "destruct net.",
            "VernacExtend",
            "3ead3c66b419e18eef776a8c646159f3625c20a0"
        ],
        [
            "unfold deghost, reghost.",
            "VernacExtend",
            "cbb8274e13a9079e289f4bf26192c56ad123a4d1"
        ],
        [
            "simpl in *.",
            "VernacExtend",
            "5f89d9715fcf9b11bc0d0aadc658e9b10c47b606"
        ],
        [
            "f_equal.",
            "VernacExtend",
            "dfce814d1efcef60f8330516ad88155a3a5ec317"
        ],
        [
            "rewrite map_map.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "map_id.",
            "VernacExtend",
            "761206c2ae11eb80460277e20eaf939ef7611867"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem ghost_invariant_lift : forall P : _ -> Prop, (forall net net' failed failed' out, @step_failure _ _ failure_params (failed, net) (failed', net') out -> P net -> P net') -> (forall net net' failed failed' out, step_failure (failed, net) (failed', net') out -> P (deghost net) -> P (deghost net')).",
            "VernacStartTheoremProof",
            "b27258eace1fad2ad8530b0261ddd4aaf1048538"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "eauto using ghost_simulation_1.",
            "VernacExtend",
            "d727ea475e3f195b5eb32d5a6e51552b493c66c9"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem ghost_invariant_lower : forall P : _ -> Prop, (forall net net' failed failed' out, step_failure (failed, net) (failed', net') out -> P (deghost net) -> P (deghost net')) -> (forall net net' failed failed' out, @step_failure _ _ failure_params (failed, net) (failed', net') out -> P net -> P net').",
            "VernacStartTheoremProof",
            "bf7b60281957f27d7570fdac4f429f923be4b403"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "apply ghost_simulation_2 with (gnet := reghost net) in H0.",
            "VernacExtend",
            "6d351ebec46b27f52b1afeb0713d59ecc5b0d71b"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "break_exists.",
            "VernacExtend",
            "7914403b406cb602431a8c9ec3a15a70b4d83870"
        ],
        [
            "intuition.",
            "VernacExtend",
            "ebd9388eeb482972743f9cce5cbddbd85ca5bdfd"
        ],
        [
            "subst.",
            "VernacExtend",
            "ccc9cb848804101be22a0bb6c324861981c5c7f1"
        ],
        [
            "eapply H; eauto.",
            "VernacExtend",
            "d625be3dbb1364dd2bd116c00aefec9fb61c11c0"
        ],
        [
            "rewrite reghost_deghost_partial_inverses.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "eauto using reghost_deghost_partial_inverses.",
            "VernacExtend",
            "2eab082ca80d32b924f42ac98ab15180a241b0b1"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "End GhostVars.",
            "VernacEndSegment",
            "b9e2d3c089f7e0572e7ce72c03964fc94edc953c"
        ],
        [
            "Class MsgGhostMultiParams `(P : MultiParams) := { ghost_msg : Type; ghost_msg_eq_dec : forall x y : ghost_msg, {x = y} + {x <> y} ; ghost_msg_default : ghost_msg ; write_ghost_msg : name -> data -> ghost_msg }.",
            "VernacInductive",
            "5aab007d3447338c252d03e99d71f264816938fe"
        ],
        [
            "Section MsgGhostVars.",
            "VernacBeginSection",
            "87524e753370c7c1a8fa056c64654aab2c4d0415"
        ],
        [
            "Context {base_params : BaseParams}.",
            "VernacContext",
            "58f95a95a12107d09c64aae51a6b1211d4c9e638"
        ],
        [
            "Context {multi_params : MultiParams base_params}.",
            "VernacContext",
            "3ae75177157bf41af529f0c2e4775e8d4d4b9bbd"
        ],
        [
            "Context {failure_params : FailureParams multi_params}.",
            "VernacContext",
            "6eded612e8273e2acc9d15ff2e2c492537f06abd"
        ],
        [
            "Context {msg_ghost_params : MsgGhostMultiParams multi_params}.",
            "VernacContext",
            "9d0c154e81f6ffdb786bb9cd338331bd5ea458e4"
        ],
        [
            "Definition add_ghost_msg (me : name) (st : data) (ps : list (name * msg)) : list (name * (ghost_msg * msg)) := map (fun m => (fst m, (write_ghost_msg me st, snd m))) ps.",
            "VernacDefinition",
            "350f4fee2796891614df38a9e494da348139cfee"
        ],
        [
            "Definition mgv_refined_net_handlers me src (m : ghost_msg * msg) st := let '(out, st', ps) := net_handlers me src (snd m) st in (out, st', add_ghost_msg me st' ps).",
            "VernacDefinition",
            "17b18392fa3074d803554d19b90920d99954a09b"
        ],
        [
            "Definition mgv_refined_input_handlers me inp st := let '(out, st', ps) := input_handlers me inp st in (out, st', add_ghost_msg me st' ps).",
            "VernacDefinition",
            "da506c4ef1d7039613a31289f09bb938d628b9a0"
        ],
        [
            "Definition mgv_msg_eq_dec : forall x y : ghost_msg * msg, {x = y} + {x <> y}.",
            "VernacDefinition",
            "5cd949dd1e7d6b1f7f44b8de69fd29aa792aa352"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "decide equality; auto using msg_eq_dec, ghost_msg_eq_dec.",
            "VernacExtend",
            "56ccc2858ab368b6875da4e1053578b83fd6091d"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Instance mgv_refined_base_params : BaseParams := { data := data ; input := input ; output := output }.",
            "VernacInstance",
            "cd4605e5e541f46b06ad1432a00fa9eb5e2ae4a7"
        ],
        [
            "Instance mgv_refined_multi_params : MultiParams _ := { name := name ; msg := (ghost_msg * msg) ; msg_eq_dec := mgv_msg_eq_dec ; name_eq_dec := name_eq_dec ; nodes := nodes ; all_names_nodes := all_names_nodes ; no_dup_nodes := no_dup_nodes ; init_handlers := init_handlers; net_handlers := mgv_refined_net_handlers ; input_handlers := mgv_refined_input_handlers }.",
            "VernacInstance",
            "7fca6b4ffc26a79641c1f211fdc17900ac2b3536"
        ],
        [
            "Instance mgv_refined_failure_params : FailureParams _ := { reboot := (@reboot base_params multi_params failure_params) }.",
            "VernacInstance",
            "f3a193428d191176884e5527056c0cd75941eb85"
        ],
        [
            "Definition mgv_deghost_packet p := @mkPacket _ multi_params (@pSrc _ mgv_refined_multi_params p) (pDst p) (snd (pBody p)).",
            "VernacDefinition",
            "8532af7fa1fe86d7ff977ae50239d6320ec5f3d7"
        ],
        [
            "Definition mgv_deghost (net : @network _ mgv_refined_multi_params) : (@network _ multi_params).",
            "VernacDefinition",
            "5ba2ec4301b8bafca089d8dceb8ea09f99a7f17e"
        ],
        [
            "refine (@mkNetwork _ multi_params (map mgv_deghost_packet (nwPackets net)) _ ).",
            "VernacExtend",
            "509ac0da18d35e4a107d7c59ddca4796772eaf64"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "destruct net.",
            "VernacExtend",
            "3ead3c66b419e18eef776a8c646159f3625c20a0"
        ],
        [
            "concludes.",
            "VernacExtend",
            "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "Defined.",
            "VernacEndProof",
            "88c0be54a50df4bb90276c075406fe442428eb9c"
        ],
        [
            "Arguments mgv_deghost_packet /_.",
            "VernacArguments",
            "e3a951224766a18019855b099788e4519f60106c"
        ],
        [
            "Instance mgv_refined_base_params_tot_map : BaseParamsTotalMap mgv_refined_base_params base_params := { tot_map_data := id ; tot_map_input := id ; tot_map_output := id }.",
            "VernacInstance",
            "3a29e0b641bc314064dee70556bd72c884d0d42e"
        ],
        [
            "Instance mgv_refined_multi_params_name_tot_map : MultiParamsNameTotalMap mgv_refined_multi_params multi_params := { tot_map_name := id ; tot_map_name_inv := id ; }.",
            "VernacInstance",
            "7c50e7e53b9e33fedd32a07968aeb531f7b72995"
        ],
        [
            "Instance mgv_refined_multi_params_name_tot_map_bijective : MultiParamsNameTotalMapBijective mgv_refined_multi_params_name_tot_map := { tot_map_name_inv_inverse := fun _ => eq_refl ; tot_map_name_inverse_inv := fun _ => eq_refl }.",
            "VernacInstance",
            "c7c38c4b206c626ef905d32d4ddcb9fe6cff4343"
        ],
        [
            "Instance mgv_refined_multi_params_tot_map : MultiParamsMsgTotalMap mgv_refined_multi_params multi_params := { tot_map_msg := snd ; }.",
            "VernacInstance",
            "55f3ea982710023ce733b23c2a9adcadcf9bc288"
        ],
        [
            "Program Instance mgv_refined_multi_params_map_congruency : MultiParamsTotalMapCongruency mgv_refined_base_params_tot_map mgv_refined_multi_params_name_tot_map mgv_refined_multi_params_tot_map := { tot_init_handlers_eq := fun _ => eq_refl ; tot_net_handlers_eq := _ ; tot_input_handlers_eq := _ }.",
            "VernacInstance",
            "738d8833659e9d97757d985f416db419b1802713"
        ],
        [
            "Next Obligation.",
            "VernacExtend",
            "de5e6a0a7a163af0d8463969c3ff4241d7d5bba0"
        ],
        [
            "rewrite /tot_mapped_net_handlers /= /mgv_refined_net_handlers /= /tot_map_name_msgs /= /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "repeat break_let.",
            "VernacExtend",
            "af4c4045b2a41d256b959f44ffccc9ee0df74742"
        ],
        [
            "find_inversion.",
            "VernacExtend",
            "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
        ],
        [
            "rewrite -/id map_id /= /add_ghost_msg /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "elim l0 => //=.",
            "VernacExtend",
            "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
        ],
        [
            "case => n m' l IH.",
            "VernacExtend",
            "e00fff71ff314c991514fc71c41a3556702e444a"
        ],
        [
            "find_inversion.",
            "VernacExtend",
            "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
        ],
        [
            "by find_rewrite; find_rewrite.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Next Obligation.",
            "VernacExtend",
            "de5e6a0a7a163af0d8463969c3ff4241d7d5bba0"
        ],
        [
            "rewrite /tot_mapped_input_handlers /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "repeat break_let.",
            "VernacExtend",
            "af4c4045b2a41d256b959f44ffccc9ee0df74742"
        ],
        [
            "rewrite map_id /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "unfold mgv_refined_input_handlers in *.",
            "VernacExtend",
            "94672207002bd4f7fd63d025ead70f942c82e24d"
        ],
        [
            "repeat break_let.",
            "VernacExtend",
            "af4c4045b2a41d256b959f44ffccc9ee0df74742"
        ],
        [
            "find_inversion.",
            "VernacExtend",
            "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
        ],
        [
            "elim l1 => //=.",
            "VernacExtend",
            "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
        ],
        [
            "case => n m l.",
            "VernacExtend",
            "e00fff71ff314c991514fc71c41a3556702e444a"
        ],
        [
            "move => IH.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "find_inversion.",
            "VernacExtend",
            "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
        ],
        [
            "by find_rewrite; find_rewrite.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Instance mgv_refined_failure_params_map_congruency : FailureParamsTotalMapCongruency mgv_refined_failure_params failure_params mgv_refined_base_params_tot_map := { tot_reboot_eq := fun _ => eq_refl }.",
            "VernacInstance",
            "1d42b77c2ec1c48e7e6360b41a1ef59e4825ef75"
        ],
        [
            "Lemma mgv_map_id_tr : forall out, map (fun e : name * (input + list output) => let (n, s) := e in match s with | inl io => (n, inl io) | inr lo => (n, inr (map id lo)) end) out = out.",
            "VernacStartTheoremProof",
            "19f7b748f6daf430bf9881257fcb2058240c6ef3"
        ],
        [
            "elim => //.",
            "VernacExtend",
            "e686a1895f1799b840b76242f931100819a9ad6c"
        ],
        [
            "move => tr l IH.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "rewrite /= IH.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "break_let.",
            "VernacExtend",
            "0d8806c04d7bd574741dfa032ad14204e251f21e"
        ],
        [
            "break_match => //.",
            "VernacExtend",
            "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
        ],
        [
            "by rewrite map_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem mgv_ghost_simulation_1 : forall net net' failed failed' out, @step_failure _ _ mgv_refined_failure_params (failed, net) (failed', net') out -> @step_failure _ _ failure_params (failed, mgv_deghost net) (failed', mgv_deghost net') out.",
            "VernacStartTheoremProof",
            "082ad20c4fb886a00b58a1c6724ce031f995bffc"
        ],
        [
            "move => net net' failed failed' out H_step.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "apply step_failure_tot_mapped_simulation_1 in H_step.",
            "VernacExtend",
            "60293bc0c8ca467960d69b34cf754929db8283af"
        ],
        [
            "rewrite /tot_map_name /tot_map_net /= 2!map_id /id /= in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /tot_map_trace_occ /= /id /= in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /tot_map_packet /= /id /= in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /mgv_deghost /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite -/id mgv_map_id_tr in H_step.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "move: H_step.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "set fp := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fp' := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq: fp = fp' by rewrite /fp /fp'; apply functional_extensionality; case => /= src dst m.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "rewrite H_eq {H_eq fp}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "set fs1 := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fs2 := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fs1' := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set fs2' := fun n => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq: fs1 = fs1' by rewrite /fs1 /fs1' {fs1 fs1'}; apply functional_extensionality => n; case: net.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "rewrite H_eq {H_eq fs1}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "have H_eq: fs2 = fs2' by rewrite /fs2 /fs2' {fs2 fs2'}; apply functional_extensionality => n; case: net'.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "by rewrite H_eq.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Definition mgv_ghost_packet p := @mkPacket _ mgv_refined_multi_params (@pSrc _ multi_params p) (pDst p) (ghost_msg_default, pBody p).",
            "VernacDefinition",
            "e821d1d476544a4eaee90b5e6d8117d9b0f85ff9"
        ],
        [
            "Definition mgv_reghost (net : @network _ multi_params) : @network _ mgv_refined_multi_params.",
            "VernacDefinition",
            "59348eb575130fa657a9bdac1be6c3755789f26d"
        ],
        [
            "refine (@mkNetwork _ mgv_refined_multi_params (map mgv_ghost_packet (nwPackets net)) _ ).",
            "VernacExtend",
            "b36456e610ba8c0add82280390694b4bcd15c51d"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "destruct net.",
            "VernacExtend",
            "3ead3c66b419e18eef776a8c646159f3625c20a0"
        ],
        [
            "concludes.",
            "VernacExtend",
            "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "Defined.",
            "VernacEndProof",
            "88c0be54a50df4bb90276c075406fe442428eb9c"
        ],
        [
            "Arguments mgv_ghost_packet /_.",
            "VernacArguments",
            "7ce8237d04917c4764815383b7c3ec8591ba3ace"
        ],
        [
            "Lemma mgv_reghost_deghost_partial_inverses : forall net, mgv_deghost (mgv_reghost net) = net.",
            "VernacStartTheoremProof",
            "f42906f8a33dee091b7307e87bc42862a2710ff3"
        ],
        [
            "destruct net.",
            "VernacExtend",
            "3ead3c66b419e18eef776a8c646159f3625c20a0"
        ],
        [
            "unfold mgv_deghost, mgv_reghost.",
            "VernacExtend",
            "18961554d174bd48916f4ef4fe4fac78bef87dc0"
        ],
        [
            "simpl in *.",
            "VernacExtend",
            "5f89d9715fcf9b11bc0d0aadc658e9b10c47b606"
        ],
        [
            "f_equal.",
            "VernacExtend",
            "dfce814d1efcef60f8330516ad88155a3a5ec317"
        ],
        [
            "rewrite map_map.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "map_id.",
            "VernacExtend",
            "761206c2ae11eb80460277e20eaf939ef7611867"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem mgv_ghost_simulation_2 : forall net net' failed failed' out gnet, @step_failure _ _ failure_params (failed, net) (failed', net') out -> mgv_deghost gnet = net -> exists gnet', step_failure (failed, gnet) (failed', gnet') out /\\ mgv_deghost gnet' = net'.",
            "VernacStartTheoremProof",
            "cdbeb329ae6e61e322d0a1330138b5c42b3c67b1"
        ],
        [
            "move => net net' failed failed' out gnet H_step H_eq.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "eapply step_failure_tot_mapped_simulation_2 in H_step => //.",
            "VernacExtend",
            "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "move: H_step => [gnet' [H_step H_eq_net]].",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "exists gnet'.",
            "VernacExtend",
            "60ddeadc3c41d3290258ab35cd0f179e963a1e4c"
        ],
        [
            "split; eauto.",
            "VernacExtend",
            "f3520b20a884376c5c10e2f9e716eedc86a566b6"
        ],
        [
            "rewrite -H_eq_net {H_step H_eq_net}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /mgv_deghost /tot_map_net /= /id /= /tot_map_packet /= /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "set nwPf1 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwPf2 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_p: nwPf1 = nwPf2 by rewrite /nwPf1 /nwPf2 {nwPf1 nwPf2}; apply functional_extensionality; case.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "set nwS1 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwS2 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_s: nwS1 = nwS2 by rewrite /nwS1 /nwS2 {nwS1 nwS2}; apply functional_extensionality => n; case: gnet'.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "by rewrite H_eq_p H_eq_s.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "rewrite -H_eq {H_step H_eq}.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "rewrite /mgv_deghost /tot_map_net /= /id /= /tot_map_packet /= /id /=.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "set nwPf1 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwPf2 := fun p : packet => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_p: nwPf1 = nwPf2 by rewrite /nwPf1 /nwPf2 {nwPf1 nwPf2}; apply functional_extensionality; case.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "set nwS1 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "set nwS2 := fun _ => _.",
            "VernacExtend",
            "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
        ],
        [
            "have H_eq_s: nwS1 = nwS2 by rewrite /nwS1 /nwS2 {nwS1 nwS2}; apply functional_extensionality => n; case: gnet.",
            "VernacExtend",
            "406cde1174359c53bf162a2a18c4eede395555f9"
        ],
        [
            "by rewrite H_eq_p H_eq_s.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "by rewrite /tot_map_name /= map_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "by rewrite /tot_map_name /= map_id.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "move {H_step}.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "elim: out => //.",
            "VernacExtend",
            "e686a1895f1799b840b76242f931100819a9ad6c"
        ],
        [
            "case => n t out IH.",
            "VernacExtend",
            "e00fff71ff314c991514fc71c41a3556702e444a"
        ],
        [
            "case: t => /=; first by move => inp; rewrite /id /= IH.",
            "VernacExtend",
            "3763a4b8db689af316a7372b722bb29806ab4fb6"
        ],
        [
            "move => out'.",
            "VernacExtend",
            "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
        ],
        [
            "by rewrite {1}/id map_id /= IH.",
            "VernacExtend",
            "ee1746465e986ababa06bb4e96ee76be726c914a"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem mgv_ghost_invariant_lift : forall P : _ -> Prop, (forall net net' failed failed' out, @step_failure _ _ failure_params (failed, net) (failed', net') out -> P net -> P net') -> (forall net net' failed failed' out, step_failure (failed, net) (failed', net') out -> P (mgv_deghost net) -> P (mgv_deghost net')).",
            "VernacStartTheoremProof",
            "b1cadf036dfe696607c6b1a916463582430d6cab"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "eauto using mgv_ghost_simulation_1.",
            "VernacExtend",
            "c0cab1dc850e5753d97022751e9cf26bbbfc9a33"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem mgv_ghost_invariant_lower : forall P : _ -> Prop, (forall net net' failed failed' out, step_failure (failed, net) (failed', net') out -> P (mgv_deghost net) -> P (mgv_deghost net')) -> (forall net net' failed failed' out, @step_failure _ _ failure_params (failed, net) (failed', net') out -> P net -> P net').",
            "VernacStartTheoremProof",
            "a02a1439c24efa2f38d1320771893572c4161d79"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "apply mgv_ghost_simulation_2 with (gnet := mgv_reghost net) in H0.",
            "VernacExtend",
            "7db7002da59020f531207f5dc28f5518481583a9"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "break_exists.",
            "VernacExtend",
            "7914403b406cb602431a8c9ec3a15a70b4d83870"
        ],
        [
            "intuition.",
            "VernacExtend",
            "ebd9388eeb482972743f9cce5cbddbd85ca5bdfd"
        ],
        [
            "subst.",
            "VernacExtend",
            "ccc9cb848804101be22a0bb6c324861981c5c7f1"
        ],
        [
            "eapply H; eauto.",
            "VernacExtend",
            "d625be3dbb1364dd2bd116c00aefec9fb61c11c0"
        ],
        [
            "rewrite mgv_reghost_deghost_partial_inverses.",
            "VernacExtend",
            "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "-",
            "VernacBullet",
            "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
        ],
        [
            "eauto using mgv_reghost_deghost_partial_inverses.",
            "VernacExtend",
            "6abbb57e39ec2f8a4c2bcf2f9703462e30ac4355"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "End MsgGhostVars.",
            "VernacEndSegment",
            "d4b63d36ed8b4022f3edb7960bd834fef1d1235b"
        ],
        [
            "Arguments deghost_packet /_ _ _ _.",
            "VernacArguments",
            "13c3aecf96cafe76ef4a55e54063530804804651"
        ],
        [
            "Arguments ghost_packet /_ _ _ _.",
            "VernacArguments",
            "5885b0f34dd744fa8609e736c89bc7cb1367b0d3"
        ],
        [
            "Arguments mgv_deghost_packet /_ _ _ _.",
            "VernacArguments",
            "925bce424831ad6766c60fd31fde846f9de76e94"
        ],
        [
            "Arguments mgv_ghost_packet /_ _ _ _.",
            "VernacArguments",
            "f1c8b3321303f76080adc594b28ece4c2da3b6f7"
        ]
    ],
    "proofs": [
        {
            "name": "deghost",
            "line_nb": 22,
            "steps": [
                {
                    "command": [
                        "refine (@mkNetwork _ multi_params (map deghost_packet (nwPackets net)) _ ).",
                        "VernacExtend",
                        "03b8bd7973ad20d278d6d7a0043d0b681bfa7ca0"
                    ]
                },
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "destruct net.",
                        "VernacExtend",
                        "3ead3c66b419e18eef776a8c646159f3625c20a0"
                    ]
                },
                {
                    "command": [
                        "concludes.",
                        "VernacExtend",
                        "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
                    ]
                },
                {
                    "command": [
                        "destruct nwState.",
                        "VernacExtend",
                        "8e8beae30b1475d5dc45fa891ca81cca7d5a69a8"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "Defined.",
                        "VernacEndProof",
                        "88c0be54a50df4bb90276c075406fe442428eb9c"
                    ]
                }
            ]
        },
        {
            "name": "refined_multi_params_map_congruency_obligation_1",
            "line_nb": 37,
            "steps": [
                {
                    "command": [
                        "rewrite /tot_mapped_net_handlers /= /refined_net_handlers /= /tot_map_name_msgs /= /id /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "repeat break_let.",
                        "VernacExtend",
                        "af4c4045b2a41d256b959f44ffccc9ee0df74742"
                    ]
                },
                {
                    "command": [
                        "find_inversion.",
                        "VernacExtend",
                        "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
                    ]
                },
                {
                    "command": [
                        "by rewrite /= -/id map_id map_fst_snd_id.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "refined_multi_params_map_congruency_obligation_2",
            "line_nb": 43,
            "steps": [
                {
                    "command": [
                        "rewrite /tot_mapped_input_handlers /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "repeat break_let.",
                        "VernacExtend",
                        "af4c4045b2a41d256b959f44ffccc9ee0df74742"
                    ]
                },
                {
                    "command": [
                        "unfold refined_input_handlers in *.",
                        "VernacExtend",
                        "37932c13c6043c6d3194fd622107e0c3e55a1de5"
                    ]
                },
                {
                    "command": [
                        "repeat break_let.",
                        "VernacExtend",
                        "af4c4045b2a41d256b959f44ffccc9ee0df74742"
                    ]
                },
                {
                    "command": [
                        "find_inversion.",
                        "VernacExtend",
                        "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
                    ]
                },
                {
                    "command": [
                        "by rewrite /id /= map_id /tot_map_name_msgs /= /id /= map_fst_snd_id.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "map_id_tr",
            "line_nb": 52,
            "steps": [
                {
                    "command": [
                        "elim => //.",
                        "VernacExtend",
                        "e686a1895f1799b840b76242f931100819a9ad6c"
                    ]
                },
                {
                    "command": [
                        "move => tr l IH.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "rewrite /= IH.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "break_let.",
                        "VernacExtend",
                        "0d8806c04d7bd574741dfa032ad14204e251f21e"
                    ]
                },
                {
                    "command": [
                        "break_match => //=.",
                        "VernacExtend",
                        "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
                    ]
                },
                {
                    "command": [
                        "by rewrite map_id.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "ghost_simulation_1",
            "line_nb": 60,
            "steps": [
                {
                    "command": [
                        "move => net net' failed failed' out H_step.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "apply step_failure_tot_mapped_simulation_1 in H_step.",
                        "VernacExtend",
                        "60293bc0c8ca467960d69b34cf754929db8283af"
                    ]
                },
                {
                    "command": [
                        "rewrite /tot_map_name /tot_map_net /= 2!map_id /id /= in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite /tot_map_trace_occ /= /id /= in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite /tot_map_packet /= /id /= in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite /deghost /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite -/id map_id_tr in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "move: H_step.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "set fp := fun p : packet => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fp' := fun p : packet => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "have H_eq: fp = fp' by rewrite /fp /fp'; apply functional_extensionality; case => /= src dst m.",
                        "VernacExtend",
                        "406cde1174359c53bf162a2a18c4eede395555f9"
                    ]
                },
                {
                    "command": [
                        "rewrite H_eq {H_eq fp}.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "set fs1 := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fs2 := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fs1' := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fs2' := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "have H_eq: fs1 = fs1' by rewrite /fs1 /fs1' {fs1 fs1'}; apply functional_extensionality => n; case: net.",
                        "VernacExtend",
                        "406cde1174359c53bf162a2a18c4eede395555f9"
                    ]
                },
                {
                    "command": [
                        "rewrite H_eq {H_eq fs1}.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "have H_eq: fs2 = fs2' by rewrite /fs2 /fs2' {fs2 fs2'}; apply functional_extensionality => n; case: net'.",
                        "VernacExtend",
                        "406cde1174359c53bf162a2a18c4eede395555f9"
                    ]
                },
                {
                    "command": [
                        "by rewrite H_eq {H_eq fs2}.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "reghost",
            "line_nb": 121,
            "steps": [
                {
                    "command": [
                        "refine (@mkNetwork _ refined_multi_params (map ghost_packet (nwPackets net)) _ ).",
                        "VernacExtend",
                        "f348ec7203f178df221f53ea88a17befa29bcfea"
                    ]
                },
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "destruct net.",
                        "VernacExtend",
                        "3ead3c66b419e18eef776a8c646159f3625c20a0"
                    ]
                },
                {
                    "command": [
                        "concludes.",
                        "VernacExtend",
                        "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
                    ]
                },
                {
                    "command": [
                        "exact (ghost_init, nwState).",
                        "VernacExtend",
                        "68f4ff83d45c00d1574178c93c1e902bb2baa408"
                    ]
                },
                {
                    "command": [
                        "Defined.",
                        "VernacEndProof",
                        "88c0be54a50df4bb90276c075406fe442428eb9c"
                    ]
                }
            ]
        },
        {
            "name": "reghost_deghost_partial_inverses",
            "line_nb": 129,
            "steps": [
                {
                    "command": [
                        "destruct net.",
                        "VernacExtend",
                        "3ead3c66b419e18eef776a8c646159f3625c20a0"
                    ]
                },
                {
                    "command": [
                        "unfold deghost, reghost.",
                        "VernacExtend",
                        "cbb8274e13a9079e289f4bf26192c56ad123a4d1"
                    ]
                },
                {
                    "command": [
                        "simpl in *.",
                        "VernacExtend",
                        "5f89d9715fcf9b11bc0d0aadc658e9b10c47b606"
                    ]
                },
                {
                    "command": [
                        "f_equal.",
                        "VernacExtend",
                        "dfce814d1efcef60f8330516ad88155a3a5ec317"
                    ]
                },
                {
                    "command": [
                        "rewrite map_map.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "map_id.",
                        "VernacExtend",
                        "761206c2ae11eb80460277e20eaf939ef7611867"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "ghost_invariant_lift",
            "line_nb": 137,
            "steps": [
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "eauto using ghost_simulation_1.",
                        "VernacExtend",
                        "d727ea475e3f195b5eb32d5a6e51552b493c66c9"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "ghost_invariant_lower",
            "line_nb": 141,
            "steps": [
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "apply ghost_simulation_2 with (gnet := reghost net) in H0.",
                        "VernacExtend",
                        "6d351ebec46b27f52b1afeb0713d59ecc5b0d71b"
                    ]
                },
                {
                    "command": [
                        "-",
                        "VernacBullet",
                        "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
                    ]
                },
                {
                    "command": [
                        "break_exists.",
                        "VernacExtend",
                        "7914403b406cb602431a8c9ec3a15a70b4d83870"
                    ]
                },
                {
                    "command": [
                        "intuition.",
                        "VernacExtend",
                        "ebd9388eeb482972743f9cce5cbddbd85ca5bdfd"
                    ]
                },
                {
                    "command": [
                        "subst.",
                        "VernacExtend",
                        "ccc9cb848804101be22a0bb6c324861981c5c7f1"
                    ]
                },
                {
                    "command": [
                        "eapply H; eauto.",
                        "VernacExtend",
                        "d625be3dbb1364dd2bd116c00aefec9fb61c11c0"
                    ]
                },
                {
                    "command": [
                        "rewrite reghost_deghost_partial_inverses.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "-",
                        "VernacBullet",
                        "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
                    ]
                },
                {
                    "command": [
                        "eauto using reghost_deghost_partial_inverses.",
                        "VernacExtend",
                        "2eab082ca80d32b924f42ac98ab15180a241b0b1"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_msg_eq_dec",
            "line_nb": 164,
            "steps": [
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "decide equality; auto using msg_eq_dec, ghost_msg_eq_dec.",
                        "VernacExtend",
                        "56ccc2858ab368b6875da4e1053578b83fd6091d"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_deghost",
            "line_nb": 172,
            "steps": [
                {
                    "command": [
                        "refine (@mkNetwork _ multi_params (map mgv_deghost_packet (nwPackets net)) _ ).",
                        "VernacExtend",
                        "509ac0da18d35e4a107d7c59ddca4796772eaf64"
                    ]
                },
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "destruct net.",
                        "VernacExtend",
                        "3ead3c66b419e18eef776a8c646159f3625c20a0"
                    ]
                },
                {
                    "command": [
                        "concludes.",
                        "VernacExtend",
                        "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "Defined.",
                        "VernacEndProof",
                        "88c0be54a50df4bb90276c075406fe442428eb9c"
                    ]
                }
            ]
        },
        {
            "name": "mgv_refined_multi_params_map_congruency_obligation_1",
            "line_nb": 185,
            "steps": [
                {
                    "command": [
                        "rewrite /tot_mapped_net_handlers /= /mgv_refined_net_handlers /= /tot_map_name_msgs /= /id /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "repeat break_let.",
                        "VernacExtend",
                        "af4c4045b2a41d256b959f44ffccc9ee0df74742"
                    ]
                },
                {
                    "command": [
                        "find_inversion.",
                        "VernacExtend",
                        "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
                    ]
                },
                {
                    "command": [
                        "rewrite -/id map_id /= /add_ghost_msg /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "elim l0 => //=.",
                        "VernacExtend",
                        "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
                    ]
                },
                {
                    "command": [
                        "case => n m' l IH.",
                        "VernacExtend",
                        "e00fff71ff314c991514fc71c41a3556702e444a"
                    ]
                },
                {
                    "command": [
                        "find_inversion.",
                        "VernacExtend",
                        "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
                    ]
                },
                {
                    "command": [
                        "by find_rewrite; find_rewrite.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_refined_multi_params_map_congruency_obligation_2",
            "line_nb": 195,
            "steps": [
                {
                    "command": [
                        "rewrite /tot_mapped_input_handlers /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "repeat break_let.",
                        "VernacExtend",
                        "af4c4045b2a41d256b959f44ffccc9ee0df74742"
                    ]
                },
                {
                    "command": [
                        "rewrite map_id /id /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "unfold mgv_refined_input_handlers in *.",
                        "VernacExtend",
                        "94672207002bd4f7fd63d025ead70f942c82e24d"
                    ]
                },
                {
                    "command": [
                        "repeat break_let.",
                        "VernacExtend",
                        "af4c4045b2a41d256b959f44ffccc9ee0df74742"
                    ]
                },
                {
                    "command": [
                        "find_inversion.",
                        "VernacExtend",
                        "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
                    ]
                },
                {
                    "command": [
                        "elim l1 => //=.",
                        "VernacExtend",
                        "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
                    ]
                },
                {
                    "command": [
                        "case => n m l.",
                        "VernacExtend",
                        "e00fff71ff314c991514fc71c41a3556702e444a"
                    ]
                },
                {
                    "command": [
                        "move => IH.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "find_inversion.",
                        "VernacExtend",
                        "f1dd355c7c2f63f8f275fc6f55ac72ee2c39f687"
                    ]
                },
                {
                    "command": [
                        "by find_rewrite; find_rewrite.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_map_id_tr",
            "line_nb": 209,
            "steps": [
                {
                    "command": [
                        "elim => //.",
                        "VernacExtend",
                        "e686a1895f1799b840b76242f931100819a9ad6c"
                    ]
                },
                {
                    "command": [
                        "move => tr l IH.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "rewrite /= IH.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "break_let.",
                        "VernacExtend",
                        "0d8806c04d7bd574741dfa032ad14204e251f21e"
                    ]
                },
                {
                    "command": [
                        "break_match => //.",
                        "VernacExtend",
                        "3c42b53d0efc26db114b00541ac5e7fcb29e6aeb"
                    ]
                },
                {
                    "command": [
                        "by rewrite map_id.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_ghost_simulation_1",
            "line_nb": 217,
            "steps": [
                {
                    "command": [
                        "move => net net' failed failed' out H_step.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "apply step_failure_tot_mapped_simulation_1 in H_step.",
                        "VernacExtend",
                        "60293bc0c8ca467960d69b34cf754929db8283af"
                    ]
                },
                {
                    "command": [
                        "rewrite /tot_map_name /tot_map_net /= 2!map_id /id /= in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite /tot_map_trace_occ /= /id /= in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite /tot_map_packet /= /id /= in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite /mgv_deghost /=.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "rewrite -/id mgv_map_id_tr in H_step.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "move: H_step.",
                        "VernacExtend",
                        "b1b2cb7a3a617cba67460b4eca1f04de3c1cc716"
                    ]
                },
                {
                    "command": [
                        "set fp := fun p : packet => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fp' := fun p : packet => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "have H_eq: fp = fp' by rewrite /fp /fp'; apply functional_extensionality; case => /= src dst m.",
                        "VernacExtend",
                        "406cde1174359c53bf162a2a18c4eede395555f9"
                    ]
                },
                {
                    "command": [
                        "rewrite H_eq {H_eq fp}.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "set fs1 := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fs2 := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fs1' := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "set fs2' := fun n => _.",
                        "VernacExtend",
                        "69a61e99b234580f7b41fa5b9655c87ba9a76f70"
                    ]
                },
                {
                    "command": [
                        "have H_eq: fs1 = fs1' by rewrite /fs1 /fs1' {fs1 fs1'}; apply functional_extensionality => n; case: net.",
                        "VernacExtend",
                        "406cde1174359c53bf162a2a18c4eede395555f9"
                    ]
                },
                {
                    "command": [
                        "rewrite H_eq {H_eq fs1}.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "have H_eq: fs2 = fs2' by rewrite /fs2 /fs2' {fs2 fs2'}; apply functional_extensionality => n; case: net'.",
                        "VernacExtend",
                        "406cde1174359c53bf162a2a18c4eede395555f9"
                    ]
                },
                {
                    "command": [
                        "by rewrite H_eq.",
                        "VernacExtend",
                        "ee1746465e986ababa06bb4e96ee76be726c914a"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_reghost",
            "line_nb": 240,
            "steps": [
                {
                    "command": [
                        "refine (@mkNetwork _ mgv_refined_multi_params (map mgv_ghost_packet (nwPackets net)) _ ).",
                        "VernacExtend",
                        "b36456e610ba8c0add82280390694b4bcd15c51d"
                    ]
                },
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "destruct net.",
                        "VernacExtend",
                        "3ead3c66b419e18eef776a8c646159f3625c20a0"
                    ]
                },
                {
                    "command": [
                        "concludes.",
                        "VernacExtend",
                        "3697d2f68611e2ea2e021baaf4e64cd81f6b62ed"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "Defined.",
                        "VernacEndProof",
                        "88c0be54a50df4bb90276c075406fe442428eb9c"
                    ]
                }
            ]
        },
        {
            "name": "mgv_reghost_deghost_partial_inverses",
            "line_nb": 248,
            "steps": [
                {
                    "command": [
                        "destruct net.",
                        "VernacExtend",
                        "3ead3c66b419e18eef776a8c646159f3625c20a0"
                    ]
                },
                {
                    "command": [
                        "unfold mgv_deghost, mgv_reghost.",
                        "VernacExtend",
                        "18961554d174bd48916f4ef4fe4fac78bef87dc0"
                    ]
                },
                {
                    "command": [
                        "simpl in *.",
                        "VernacExtend",
                        "5f89d9715fcf9b11bc0d0aadc658e9b10c47b606"
                    ]
                },
                {
                    "command": [
                        "f_equal.",
                        "VernacExtend",
                        "dfce814d1efcef60f8330516ad88155a3a5ec317"
                    ]
                },
                {
                    "command": [
                        "rewrite map_map.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "map_id.",
                        "VernacExtend",
                        "761206c2ae11eb80460277e20eaf939ef7611867"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_ghost_invariant_lift",
            "line_nb": 294,
            "steps": [
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "eauto using mgv_ghost_simulation_1.",
                        "VernacExtend",
                        "c0cab1dc850e5753d97022751e9cf26bbbfc9a33"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "mgv_ghost_invariant_lower",
            "line_nb": 298,
            "steps": [
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "apply mgv_ghost_simulation_2 with (gnet := mgv_reghost net) in H0.",
                        "VernacExtend",
                        "7db7002da59020f531207f5dc28f5518481583a9"
                    ]
                },
                {
                    "command": [
                        "-",
                        "VernacBullet",
                        "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
                    ]
                },
                {
                    "command": [
                        "break_exists.",
                        "VernacExtend",
                        "7914403b406cb602431a8c9ec3a15a70b4d83870"
                    ]
                },
                {
                    "command": [
                        "intuition.",
                        "VernacExtend",
                        "ebd9388eeb482972743f9cce5cbddbd85ca5bdfd"
                    ]
                },
                {
                    "command": [
                        "subst.",
                        "VernacExtend",
                        "ccc9cb848804101be22a0bb6c324861981c5c7f1"
                    ]
                },
                {
                    "command": [
                        "eapply H; eauto.",
                        "VernacExtend",
                        "d625be3dbb1364dd2bd116c00aefec9fb61c11c0"
                    ]
                },
                {
                    "command": [
                        "rewrite mgv_reghost_deghost_partial_inverses.",
                        "VernacExtend",
                        "2a624b3f8ed2cb60890f98119d86e3031fa09e35"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "-",
                        "VernacBullet",
                        "581cab4bf49fa4b495e569bbda96fc8d28fddcc0"
                    ]
                },
                {
                    "command": [
                        "eauto using mgv_reghost_deghost_partial_inverses.",
                        "VernacExtend",
                        "6abbb57e39ec2f8a4c2bcf2f9703462e30ac4355"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        }
    ]
}