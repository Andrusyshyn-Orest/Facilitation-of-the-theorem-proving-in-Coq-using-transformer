{
    "filename": "theories/WeightTree.v",
    "coq_project": "huffman",
    "vernac_cmds": [
        [
            "From Huffman Require Export BTree.",
            "VernacRequire",
            "636e70830c7ee0ace75bfe9e4fd6a728a7dab71e"
        ],
        [
            "From Huffman Require Export Ordered.",
            "VernacRequire",
            "77de947c353dd2c96810316f90fdf903390444da"
        ],
        [
            "Require Import ArithRing.",
            "VernacRequire",
            "4bc385370568ddd53384be919634bc0439bf028f"
        ],
        [
            "Section WeightTree.",
            "VernacBeginSection",
            "b5ef3383639a75a5404df6dad9a3182badaa8811"
        ],
        [
            "Variable A : Type.",
            "VernacAssumption",
            "8c1a433b6dc10de37f30039d70ed7113b3dab0e0"
        ],
        [
            "Variable f : A -> nat.",
            "VernacAssumption",
            "9f23c668cb9b44da0a7007cf5e6e948fbeb3f99a"
        ],
        [
            "Fixpoint sum_leaves (t : btree A) : nat := match t with | leaf n => f n | node t1 t2 => sum_leaves t1 + sum_leaves t2 end.",
            "VernacFixpoint",
            "3444537da2d683448d0adf30a956d7d8d925df22"
        ],
        [
            "Definition sum_order x y := sum_leaves x <= sum_leaves y.",
            "VernacDefinition",
            "0a73facb48bee58fa9a8e498988a9a87d3aa61b3"
        ],
        [
            "Definition le_sum x y := le_bool (sum_leaves x) (sum_leaves y).",
            "VernacDefinition",
            "e3e47a6f2784c2fb64a155c04f6ac851352baaf7"
        ],
        [
            "Theorem le_sum_correct1 : forall a b1 : btree A, le_sum a b1 = true -> sum_order a b1.",
            "VernacStartTheoremProof",
            "6c2ab4d9675aee05b20472c8d38e2aaac19a0ed6"
        ],
        [
            "intros a b1; apply (le_bool_correct3 (sum_leaves a) (sum_leaves b1)).",
            "VernacExtend",
            "f5fd2106087e2bb54c73b5392fbc9bd9f997b260"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem le_sum_correct2 : forall a b1 : btree A, le_sum a b1 = false -> sum_order b1 a.",
            "VernacStartTheoremProof",
            "06052092f702e397dc3d3c2bed762cee5bf31057"
        ],
        [
            "intros a b1; apply (le_bool_correct4 (sum_leaves a) (sum_leaves b1)).",
            "VernacExtend",
            "b30dc3422cf0f29d2bd530eecfb5d46ec95dcf97"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Fixpoint weight_tree (t : btree A) : nat := match t with | leaf n => 0 | node t1 t2 => sum_leaves t1 + weight_tree t1 + (sum_leaves t2 + weight_tree t2) end.",
            "VernacFixpoint",
            "cef6b339fb2f7abe2a616947ada9ac4957cce99b"
        ],
        [
            "Definition weight_tree_list : list (btree A) -> nat := fold_right (fun x : btree A => plus (weight_tree x)) 0.",
            "VernacDefinition",
            "220cc56ccb9d6f606b17e6c9056c07115b1bcbd1"
        ],
        [
            "Theorem weight_tree_list_node : forall (t1 t2 : btree A) (l : list (btree A)), weight_tree_list (node t1 t2 :: l) = sum_leaves t1 + sum_leaves t2 + weight_tree_list (t1 :: t2 :: l).",
            "VernacStartTheoremProof",
            "63285bcc7e74024fa1f6253998090bf3aa822661"
        ],
        [
            "intros t1 t2 l; simpl in |- *; ring.",
            "VernacExtend",
            "b7ddc3e33f229589f84cc89886c8006f4bedd18e"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Theorem weight_tree_list_permutation : forall l1 l2 : list (btree A), permutation l1 l2 -> weight_tree_list l1 = weight_tree_list l2.",
            "VernacStartTheoremProof",
            "5adab72b44ab0d1b0a565ae853079e8b3051c271"
        ],
        [
            "intros l1 l2 H; elim H; auto.",
            "VernacExtend",
            "b93d03e5f02e374a1fe509e7c88e5bf12edfb0fb"
        ],
        [
            "simpl in |- *; auto; intros; ring.",
            "VernacExtend",
            "3fb35c03157aae65970fe3d8acb40b56e95407aa"
        ],
        [
            "simpl in |- *; auto; intros; ring.",
            "VernacExtend",
            "3fb35c03157aae65970fe3d8acb40b56e95407aa"
        ],
        [
            "intros l0 l3 l4 H0 H1 H2 H3; apply trans_equal with (1 := H1); auto.",
            "VernacExtend",
            "b97bd6fa002ac72f185a635afbdf6af033dbf3b2"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "End WeightTree.",
            "VernacEndSegment",
            "f95ac0daa5ab43c8f9ac1c8169cf69a06a40b553"
        ],
        [
            "Arguments sum_leaves [A].",
            "VernacArguments",
            "d808d2b11eb6ed48ffc65e596bc20fd6cb793028"
        ],
        [
            "Arguments sum_order [A].",
            "VernacArguments",
            "3e2e96999e5fa61f32874597974043531fe2f9e3"
        ],
        [
            "Arguments le_sum [A].",
            "VernacArguments",
            "09071f5e3b3a176e736f879da2a177a106119171"
        ],
        [
            "Arguments weight_tree [A].",
            "VernacArguments",
            "900df3a204aac3a956bb99c0f74baf3d262c0e9f"
        ],
        [
            "Arguments weight_tree_list [A].",
            "VernacArguments",
            "7521d24b8ad0e8547b9b4230dbb47380a3fb8b68"
        ],
        [
            "Theorem ordered_sum_leaves_eq : forall (A : Type) (f : A -> nat) (l1 l2 : list (btree A)), permutation l1 l2 -> ordered (sum_order f) l1 -> ordered (sum_order f) l2 -> map (sum_leaves f) l1 = map (sum_leaves f) l2.",
            "VernacStartTheoremProof",
            "b92aa1a9823978d9c7ecc60d059fb447b0e27cd4"
        ],
        [
            "intros A f l1 l2 H H0 H1.",
            "VernacExtend",
            "1d7cfe2b53b637bb489a7361c3f666ce9fc3927e"
        ],
        [
            "apply ordered_perm_antisym_eq with (order := le).",
            "VernacExtend",
            "3ad97f07ab97938bf373ce65c66eea3e87db2c97"
        ],
        [
            "exact le_trans.",
            "VernacExtend",
            "13a945d76187193047a580d158ad861a6a75e9d4"
        ],
        [
            "exact le_antisym.",
            "VernacExtend",
            "7cf1859bc362a6e0c2e3fddd0ec2023d7b43d271"
        ],
        [
            "apply permutation_map; auto.",
            "VernacExtend",
            "999029f30a24e8f5a8628c93d8bf1d3ad158eb91"
        ],
        [
            "apply ordered_map_inv; auto.",
            "VernacExtend",
            "88241fd9c931ef4ea0641d5e3015739865314d42"
        ],
        [
            "apply ordered_map_inv; auto.",
            "VernacExtend",
            "88241fd9c931ef4ea0641d5e3015739865314d42"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ]
    ],
    "proofs": [
        {
            "name": "le_sum_correct1",
            "line_nb": 9,
            "steps": [
                {
                    "command": [
                        "intros a b1; apply (le_bool_correct3 (sum_leaves a) (sum_leaves b1)).",
                        "VernacExtend",
                        "f5fd2106087e2bb54c73b5392fbc9bd9f997b260"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "le_sum_correct2",
            "line_nb": 12,
            "steps": [
                {
                    "command": [
                        "intros a b1; apply (le_bool_correct4 (sum_leaves a) (sum_leaves b1)).",
                        "VernacExtend",
                        "b30dc3422cf0f29d2bd530eecfb5d46ec95dcf97"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "weight_tree_list_node",
            "line_nb": 17,
            "steps": [
                {
                    "command": [
                        "intros t1 t2 l; simpl in |- *; ring.",
                        "VernacExtend",
                        "b7ddc3e33f229589f84cc89886c8006f4bedd18e"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "weight_tree_list_permutation",
            "line_nb": 20,
            "steps": [
                {
                    "command": [
                        "intros l1 l2 H; elim H; auto.",
                        "VernacExtend",
                        "b93d03e5f02e374a1fe509e7c88e5bf12edfb0fb"
                    ]
                },
                {
                    "command": [
                        "simpl in |- *; auto; intros; ring.",
                        "VernacExtend",
                        "3fb35c03157aae65970fe3d8acb40b56e95407aa"
                    ]
                },
                {
                    "command": [
                        "simpl in |- *; auto; intros; ring.",
                        "VernacExtend",
                        "3fb35c03157aae65970fe3d8acb40b56e95407aa"
                    ]
                },
                {
                    "command": [
                        "intros l0 l3 l4 H0 H1 H2 H3; apply trans_equal with (1 := H1); auto.",
                        "VernacExtend",
                        "b97bd6fa002ac72f185a635afbdf6af033dbf3b2"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "ordered_sum_leaves_eq",
            "line_nb": 32,
            "steps": [
                {
                    "command": [
                        "intros A f l1 l2 H H0 H1.",
                        "VernacExtend",
                        "1d7cfe2b53b637bb489a7361c3f666ce9fc3927e"
                    ]
                },
                {
                    "command": [
                        "apply ordered_perm_antisym_eq with (order := le).",
                        "VernacExtend",
                        "3ad97f07ab97938bf373ce65c66eea3e87db2c97"
                    ]
                },
                {
                    "command": [
                        "exact le_trans.",
                        "VernacExtend",
                        "13a945d76187193047a580d158ad861a6a75e9d4"
                    ]
                },
                {
                    "command": [
                        "exact le_antisym.",
                        "VernacExtend",
                        "7cf1859bc362a6e0c2e3fddd0ec2023d7b43d271"
                    ]
                },
                {
                    "command": [
                        "apply permutation_map; auto.",
                        "VernacExtend",
                        "999029f30a24e8f5a8628c93d8bf1d3ad158eb91"
                    ]
                },
                {
                    "command": [
                        "apply ordered_map_inv; auto.",
                        "VernacExtend",
                        "88241fd9c931ef4ea0641d5e3015739865314d42"
                    ]
                },
                {
                    "command": [
                        "apply ordered_map_inv; auto.",
                        "VernacExtend",
                        "88241fd9c931ef4ea0641d5e3015739865314d42"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        }
    ]
}