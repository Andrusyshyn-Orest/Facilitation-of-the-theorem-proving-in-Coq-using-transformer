{
    "filename": "closeIsSecure.v",
    "coq_project": "fssec-model",
    "vernac_cmds": [
        [
            "Require Import ModelProperties.",
            "VernacRequire",
            "36aeb2145b633bf3f167714cc4cbe97055268f14"
        ],
        [
            "Require Import AuxiliaryLemmas.",
            "VernacRequire",
            "41bddd0878d8a575e0d9d8b778ab8a11c3abf46b"
        ],
        [
            "Section closeIsSecure.",
            "VernacBeginSection",
            "63e943e04434f5a49f1dfb64abde6f82af9d1d4e"
        ],
        [
            "Lemma ClosePSS : forall (s t : SFSstate) (u : SUBJECT), FuncPre5 s -> SecureState s -> TransFunc u s Close t -> SecureState t.",
            "VernacStartTheoremProof",
            "558a44a62f09e00f9d5761c2f7bfffb6fd2b162e"
        ],
        [
            "intros s t Sub FP5 SS TF; inversion TF.",
            "VernacExtend",
            "96837ae6992457924f39f01923dd170b389ac7b3"
        ],
        [
            "inversion H.",
            "VernacExtend",
            "ee20838bdd77512b43142d655a3924bf07bffebb"
        ],
        [
            "unfold SecureState in |- *.",
            "VernacExtend",
            "c37cc3e1e7e02cdb5d024be3fae2a1c5b8217014"
        ],
        [
            "BreakSS.",
            "VernacExtend",
            "eaf10a5c391c3d7b57708ac02150f3361cce764c"
        ],
        [
            "split.",
            "VernacExtend",
            "55abc140132bd88981001ac656020469a8d503eb"
        ],
        [
            "unfold DACSecureState in |- *; intros; simpl in |- *.",
            "VernacExtend",
            "935825b8f65eb06e10dcc7ef112477dd7cd20bbc"
        ],
        [
            "elim (OBJeq_dec o o0); intro y0.",
            "VernacExtend",
            "1b4ea03e80620d8b92e4fbafa60686c3c70e7799"
        ],
        [
            "rewrite <- y0.",
            "VernacExtend",
            "bea4b18ce4700c623c0ef6498ec62f190e4c3d09"
        ],
        [
            "elim (SUBeq_dec Sub u0); intro y1.",
            "VernacExtend",
            "d6c74c5ef25d8904fa33d2326844e22e647fbd65"
        ],
        [
            "rewrite <- y1.",
            "VernacExtend",
            "cf2a5f515ad71a452445e17d43b0ff6ef01f9a49"
        ],
        [
            "cut match fsecmat (close_sm s Sub o) o with | None => True | Some y => ~ set_In Sub (ActReaders y) /\\ ~ set_In Sub (ActWriters y) end.",
            "VernacExtend",
            "82989423621ef46b232073a35fc6374852a20079"
        ],
        [
            "elim (fsecmat (close_sm s Sub o) o).",
            "VernacExtend",
            "a48056ccab902938ae582137f78a364149d6d03f"
        ],
        [
            "intros; split; intro; tauto.",
            "VernacExtend",
            "09c80e936e41813d4d72d8ae4f2d2ae6b0689da9"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "apply Close_smCorr; auto.",
            "VernacExtend",
            "476f2a691cc2d0bb2ef77ca900c93eea92e4897f"
        ],
        [
            "cut match fsecmat (close_sm s Sub o) o, fsecmat (secmat s) o with | _, None => False | None, Some z => True | Some y, Some z => (set_In u0 (ActReaders y) -> set_In u0 (ActReaders z)) /\\ (set_In u0 (ActWriters y) -> set_In u0 (ActWriters z)) end.",
            "VernacExtend",
            "27bcf7dd914c8fa1e30e38edc799bcf67b76d688"
        ],
        [
            "cut match fsecmat (secmat s) o with | None => True | Some y => (set_In u0 (ActReaders y) -> PreDACRead s u0 o) /\\ (set_In u0 (ActWriters y) -> PreDACWrite s u0 o) end.",
            "VernacExtend",
            "f9f3a9ca0954363eae52ada79032c697490c95cf"
        ],
        [
            "unfold close_sm at 3 4, PreDACRead, PreDACWrite in |- *; simpl in |- *; elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o).",
            "VernacExtend",
            "43791a68fde742e179cd722b687b721c2977539c"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "elim H6; elim H5; intros.",
            "VernacExtend",
            "48a015aad633752eed009bedf6985ba2890614f9"
        ],
        [
            "split; intro.",
            "VernacExtend",
            "966a6edea9c2088caf0e546be884ea531f6207b3"
        ],
        [
            "apply H7; apply H9; auto.",
            "VernacExtend",
            "fe1e67db8d76dc38768fe9eb83d57f09a5212ce7"
        ],
        [
            "apply H8; apply H10; auto.",
            "VernacExtend",
            "9431c948d0407a7f734633792da49011fdc903a1"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "tauto.",
            "VernacExtend",
            "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "unfold DACSecureState in DAC; apply DAC.",
            "VernacExtend",
            "96d165828c6187a59a6c131e01a5e94352a7d4cb"
        ],
        [
            "apply Close_smCorr2; auto.",
            "VernacExtend",
            "0005fad0d578d6677cde53a155fa9f1eba14b6a0"
        ],
        [
            "replace (fsecmat (close_sm s Sub o) o0) with (fsecmat (secmat s) o0).",
            "VernacExtend",
            "3d26eceb1266e91b3b1410aa8a56c3f771e1b346"
        ],
        [
            "unfold close_sm, PreDACRead, PreDACWrite in |- *; simpl in |- *; unfold DACSecureState, PreDACRead, PreDACWrite in DAC; apply DAC.",
            "VernacExtend",
            "8c7780314490322d24bcf88ab57a6d606affe92d"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "unfold MACSecureState in |- *; intros; simpl in |- *.",
            "VernacExtend",
            "2b152f0f13bd561138fc059b576f3d8a5623f4d9"
        ],
        [
            "elim (OBJeq_dec o o0); intro y0.",
            "VernacExtend",
            "1b4ea03e80620d8b92e4fbafa60686c3c70e7799"
        ],
        [
            "rewrite <- y0.",
            "VernacExtend",
            "bea4b18ce4700c623c0ef6498ec62f190e4c3d09"
        ],
        [
            "cut match fsecmat (close_sm s Sub o) o, fsecmat (secmat s) o with | _, None => False | None, Some z => True | Some y, Some z => (set_In u0 (ActReaders y) -> set_In u0 (ActReaders z)) /\\ (set_In u0 (ActWriters y) -> set_In u0 (ActWriters z)) end.",
            "VernacExtend",
            "27bcf7dd914c8fa1e30e38edc799bcf67b76d688"
        ],
        [
            "cut match fsecmat (secmat s) o, fOSC (objectSC s) o, fSSC (subjectSC s) u0 with | None, _, _ => True | _, None, _ => True | _, _, None => True | Some x, Some y, Some z => set_In u0 (ActReaders x) \\/ set_In u0 (ActWriters x) -> le_sc y z end.",
            "VernacExtend",
            "bd4ca9fa125e82943f08317cacb012393e1b4a55"
        ],
        [
            "elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o); elim (fOSC (objectSC s) o); elim (fSSC (subjectSC s) u0); contradiction || trivial.",
            "VernacExtend",
            "a3265b3a6b0d395769a6da6270b7f7c7099e59b1"
        ],
        [
            "tauto.",
            "VernacExtend",
            "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
        ],
        [
            "unfold MACSecureState in MAC; apply MAC.",
            "VernacExtend",
            "7001554d3568352095d772c7b7be3064c2fc36d7"
        ],
        [
            "apply Close_smCorr2; auto.",
            "VernacExtend",
            "0005fad0d578d6677cde53a155fa9f1eba14b6a0"
        ],
        [
            "replace (fsecmat (close_sm s Sub o) o0) with (fsecmat (secmat s) o0).",
            "VernacExtend",
            "3d26eceb1266e91b3b1410aa8a56c3f771e1b346"
        ],
        [
            "unfold MACSecureState in MAC; apply MAC.",
            "VernacExtend",
            "7001554d3568352095d772c7b7be3064c2fc36d7"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Lemma ClosePSP : forall (s t : SFSstate) (u : SUBJECT), FuncPre5 s -> StarProperty s -> TransFunc u s Close t -> StarProperty t.",
            "VernacStartTheoremProof",
            "84c2b505fb3e396d2079e9f067ae0a2160cd2366"
        ],
        [
            "intros s t Sub FP5 SP TF; inversion TF.",
            "VernacExtend",
            "c66de50a982c55604fe6bbc9b5f256b0e5c505c6"
        ],
        [
            "inversion H.",
            "VernacExtend",
            "ee20838bdd77512b43142d655a3924bf07bffebb"
        ],
        [
            "unfold StarProperty in |- *; simpl in |- *; intros.",
            "VernacExtend",
            "e8be7ca5cde24677c8250848fb8f09cdf9d2bb29"
        ],
        [
            "cut match fsecmat (secmat s) o1, fsecmat (secmat s) o2, fOSC (objectSC s) o2, fOSC (objectSC s) o1 with | None, _, _, _ => True | _, None, _, _ => True | _, _, None, _ => True | _, _, _, None => True | Some w, Some x, Some y, Some z => set_In u0 (ActWriters w) -> set_In u0 (ActReaders x) -> le_sc y z end.",
            "VernacExtend",
            "976496c2502e75806a722953eaffb4df0dd0e977"
        ],
        [
            "cut match fsecmat (close_sm s Sub o) o, fsecmat (secmat s) o with | _, None => False | None, Some z => True | Some y, Some z => (set_In u0 (ActReaders y) -> set_In u0 (ActReaders z)) /\\ (set_In u0 (ActWriters y) -> set_In u0 (ActWriters z)) end.",
            "VernacExtend",
            "27bcf7dd914c8fa1e30e38edc799bcf67b76d688"
        ],
        [
            "elim (OBJeq_dec o o1); elim (OBJeq_dec o o2); intros EQ2 EQ1.",
            "VernacExtend",
            "556b2bdc98752f2a8b669378f0a11d00966187f8"
        ],
        [
            "rewrite <- EQ1; rewrite <- EQ2.",
            "VernacExtend",
            "fd41ba1eb2825b98b8dfd2197d0b80dc285f159e"
        ],
        [
            "elim (fsecmat (secmat s) o); elim (fOSC (objectSC s) o); elim (fsecmat (close_sm s Sub o) o); intros; auto.",
            "VernacExtend",
            "6d7520596d7ce61c19c678db17bd95df5feb9502"
        ],
        [
            "replace (fsecmat (close_sm s Sub o) o2) with (fsecmat (secmat s) o2).",
            "VernacExtend",
            "947ceab186fbc23b1909b5bc85ff4aff8dd45277"
        ],
        [
            "rewrite <- EQ1.",
            "VernacExtend",
            "b92e83c4536bd262dd6320d59eb18e271ed9d40d"
        ],
        [
            "elim (fsecmat (secmat s) o2); elim (fOSC (objectSC s) o); elim (fOSC (objectSC s) o2); elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o); intros; contradiction || auto.",
            "VernacExtend",
            "1af233ced5fc0de88be137a49cf6373343448b75"
        ],
        [
            "tauto.",
            "VernacExtend",
            "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "replace (fsecmat (close_sm s Sub o) o1) with (fsecmat (secmat s) o1).",
            "VernacExtend",
            "87eb8bb2a7fa533a96e0ac5baf9f4f7e6751e2bf"
        ],
        [
            "rewrite <- EQ2.",
            "VernacExtend",
            "681d28912b80a73973932919e02efd4f68e2a471"
        ],
        [
            "elim (fsecmat (secmat s) o1); elim (fOSC (objectSC s) o); elim (fOSC (objectSC s) o1); elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o); intros; contradiction || auto.",
            "VernacExtend",
            "180d35843f8aefb9e3f6f6d21855e6ab23007303"
        ],
        [
            "tauto.",
            "VernacExtend",
            "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "replace (fsecmat (close_sm s Sub o) o2) with (fsecmat (secmat s) o2).",
            "VernacExtend",
            "947ceab186fbc23b1909b5bc85ff4aff8dd45277"
        ],
        [
            "replace (fsecmat (close_sm s Sub o) o1) with (fsecmat (secmat s) o1).",
            "VernacExtend",
            "87eb8bb2a7fa533a96e0ac5baf9f4f7e6751e2bf"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "auto.",
            "VernacExtend",
            "1f09da0addd069b3b65326f8c71967acc1e985af"
        ],
        [
            "apply Close_smCorr2; auto.",
            "VernacExtend",
            "0005fad0d578d6677cde53a155fa9f1eba14b6a0"
        ],
        [
            "unfold StarProperty in SP; apply SP.",
            "VernacExtend",
            "0b3038e16767bc624e3452c2ae802c795e89ae12"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "Lemma ClosePCP : forall s t : SFSstate, PreservesControlProp s Close t.",
            "VernacStartTheoremProof",
            "6b1b0659a8e932019775e07728463fc95c9d70cb"
        ],
        [
            "intros; unfold PreservesControlProp in |- *; intros Sub TF; inversion TF; unfold ControlProperty in |- *.",
            "VernacExtend",
            "cb89a7246511afaf66c06dd1c902bc1192b4f982"
        ],
        [
            "inversion H.",
            "VernacExtend",
            "ee20838bdd77512b43142d655a3924bf07bffebb"
        ],
        [
            "split.",
            "VernacExtend",
            "55abc140132bd88981001ac656020469a8d503eb"
        ],
        [
            "intros.",
            "VernacExtend",
            "1b4df911c5412d25278e46f48402870ba987996b"
        ],
        [
            "split.",
            "VernacExtend",
            "55abc140132bd88981001ac656020469a8d503eb"
        ],
        [
            "intros; absurd (DACCtrlAttrHaveChanged s (mkSFS (groups s) (primaryGrp s) (subjectSC s) (AllGrp s) (RootGrp s) (SecAdmGrp s) (objectSC s) (acl s) (close_sm s Sub o) (files s) (directories s)) o0); auto.",
            "VernacExtend",
            "48e87aead00feef80c85037ee8a67342e9d84d7b"
        ],
        [
            "intros; absurd (MACObjCtrlAttrHaveChanged s (mkSFS (groups s) (primaryGrp s) (subjectSC s) (AllGrp s) (RootGrp s) (SecAdmGrp s) (objectSC s) (acl s) (close_sm s Sub o) (files s) (directories s)) o0); auto.",
            "VernacExtend",
            "55a717e398e94791656ca14e33a4175f4847f361"
        ],
        [
            "intros; absurd (MACSubCtrlAttrHaveChanged s (mkSFS (groups s) (primaryGrp s) (subjectSC s) (AllGrp s) (RootGrp s) (SecAdmGrp s) (objectSC s) (acl s) (close_sm s Sub o) (files s) (directories s)) u0); auto.",
            "VernacExtend",
            "b76c71c405ac8275c7c35d11c4f66db6aec09296"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ],
        [
            "End closeIsSecure.",
            "VernacEndSegment",
            "664ea6f489809acdc194cbee9e526f86ef6a5fd9"
        ],
        [
            "Hint Resolve ClosePSS ClosePSP ClosePCP.",
            "VernacHints",
            "42a63f8ec1385bbd489b633c4249ba48303378b8"
        ]
    ],
    "proofs": [
        {
            "name": "ClosePSS",
            "line_nb": 3,
            "steps": [
                {
                    "command": [
                        "intros s t Sub FP5 SS TF; inversion TF.",
                        "VernacExtend",
                        "96837ae6992457924f39f01923dd170b389ac7b3"
                    ]
                },
                {
                    "command": [
                        "inversion H.",
                        "VernacExtend",
                        "ee20838bdd77512b43142d655a3924bf07bffebb"
                    ]
                },
                {
                    "command": [
                        "unfold SecureState in |- *.",
                        "VernacExtend",
                        "c37cc3e1e7e02cdb5d024be3fae2a1c5b8217014"
                    ]
                },
                {
                    "command": [
                        "BreakSS.",
                        "VernacExtend",
                        "eaf10a5c391c3d7b57708ac02150f3361cce764c"
                    ]
                },
                {
                    "command": [
                        "split.",
                        "VernacExtend",
                        "55abc140132bd88981001ac656020469a8d503eb"
                    ]
                },
                {
                    "command": [
                        "unfold DACSecureState in |- *; intros; simpl in |- *.",
                        "VernacExtend",
                        "935825b8f65eb06e10dcc7ef112477dd7cd20bbc"
                    ]
                },
                {
                    "command": [
                        "elim (OBJeq_dec o o0); intro y0.",
                        "VernacExtend",
                        "1b4ea03e80620d8b92e4fbafa60686c3c70e7799"
                    ]
                },
                {
                    "command": [
                        "rewrite <- y0.",
                        "VernacExtend",
                        "bea4b18ce4700c623c0ef6498ec62f190e4c3d09"
                    ]
                },
                {
                    "command": [
                        "elim (SUBeq_dec Sub u0); intro y1.",
                        "VernacExtend",
                        "d6c74c5ef25d8904fa33d2326844e22e647fbd65"
                    ]
                },
                {
                    "command": [
                        "rewrite <- y1.",
                        "VernacExtend",
                        "cf2a5f515ad71a452445e17d43b0ff6ef01f9a49"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (close_sm s Sub o) o with | None => True | Some y => ~ set_In Sub (ActReaders y) /\\ ~ set_In Sub (ActWriters y) end.",
                        "VernacExtend",
                        "82989423621ef46b232073a35fc6374852a20079"
                    ]
                },
                {
                    "command": [
                        "elim (fsecmat (close_sm s Sub o) o).",
                        "VernacExtend",
                        "a48056ccab902938ae582137f78a364149d6d03f"
                    ]
                },
                {
                    "command": [
                        "intros; split; intro; tauto.",
                        "VernacExtend",
                        "09c80e936e41813d4d72d8ae4f2d2ae6b0689da9"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "apply Close_smCorr; auto.",
                        "VernacExtend",
                        "476f2a691cc2d0bb2ef77ca900c93eea92e4897f"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (close_sm s Sub o) o, fsecmat (secmat s) o with | _, None => False | None, Some z => True | Some y, Some z => (set_In u0 (ActReaders y) -> set_In u0 (ActReaders z)) /\\ (set_In u0 (ActWriters y) -> set_In u0 (ActWriters z)) end.",
                        "VernacExtend",
                        "27bcf7dd914c8fa1e30e38edc799bcf67b76d688"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (secmat s) o with | None => True | Some y => (set_In u0 (ActReaders y) -> PreDACRead s u0 o) /\\ (set_In u0 (ActWriters y) -> PreDACWrite s u0 o) end.",
                        "VernacExtend",
                        "f9f3a9ca0954363eae52ada79032c697490c95cf"
                    ]
                },
                {
                    "command": [
                        "unfold close_sm at 3 4, PreDACRead, PreDACWrite in |- *; simpl in |- *; elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o).",
                        "VernacExtend",
                        "43791a68fde742e179cd722b687b721c2977539c"
                    ]
                },
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "elim H6; elim H5; intros.",
                        "VernacExtend",
                        "48a015aad633752eed009bedf6985ba2890614f9"
                    ]
                },
                {
                    "command": [
                        "split; intro.",
                        "VernacExtend",
                        "966a6edea9c2088caf0e546be884ea531f6207b3"
                    ]
                },
                {
                    "command": [
                        "apply H7; apply H9; auto.",
                        "VernacExtend",
                        "fe1e67db8d76dc38768fe9eb83d57f09a5212ce7"
                    ]
                },
                {
                    "command": [
                        "apply H8; apply H10; auto.",
                        "VernacExtend",
                        "9431c948d0407a7f734633792da49011fdc903a1"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "tauto.",
                        "VernacExtend",
                        "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "unfold DACSecureState in DAC; apply DAC.",
                        "VernacExtend",
                        "96d165828c6187a59a6c131e01a5e94352a7d4cb"
                    ]
                },
                {
                    "command": [
                        "apply Close_smCorr2; auto.",
                        "VernacExtend",
                        "0005fad0d578d6677cde53a155fa9f1eba14b6a0"
                    ]
                },
                {
                    "command": [
                        "replace (fsecmat (close_sm s Sub o) o0) with (fsecmat (secmat s) o0).",
                        "VernacExtend",
                        "3d26eceb1266e91b3b1410aa8a56c3f771e1b346"
                    ]
                },
                {
                    "command": [
                        "unfold close_sm, PreDACRead, PreDACWrite in |- *; simpl in |- *; unfold DACSecureState, PreDACRead, PreDACWrite in DAC; apply DAC.",
                        "VernacExtend",
                        "8c7780314490322d24bcf88ab57a6d606affe92d"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "unfold MACSecureState in |- *; intros; simpl in |- *.",
                        "VernacExtend",
                        "2b152f0f13bd561138fc059b576f3d8a5623f4d9"
                    ]
                },
                {
                    "command": [
                        "elim (OBJeq_dec o o0); intro y0.",
                        "VernacExtend",
                        "1b4ea03e80620d8b92e4fbafa60686c3c70e7799"
                    ]
                },
                {
                    "command": [
                        "rewrite <- y0.",
                        "VernacExtend",
                        "bea4b18ce4700c623c0ef6498ec62f190e4c3d09"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (close_sm s Sub o) o, fsecmat (secmat s) o with | _, None => False | None, Some z => True | Some y, Some z => (set_In u0 (ActReaders y) -> set_In u0 (ActReaders z)) /\\ (set_In u0 (ActWriters y) -> set_In u0 (ActWriters z)) end.",
                        "VernacExtend",
                        "27bcf7dd914c8fa1e30e38edc799bcf67b76d688"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (secmat s) o, fOSC (objectSC s) o, fSSC (subjectSC s) u0 with | None, _, _ => True | _, None, _ => True | _, _, None => True | Some x, Some y, Some z => set_In u0 (ActReaders x) \\/ set_In u0 (ActWriters x) -> le_sc y z end.",
                        "VernacExtend",
                        "bd4ca9fa125e82943f08317cacb012393e1b4a55"
                    ]
                },
                {
                    "command": [
                        "elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o); elim (fOSC (objectSC s) o); elim (fSSC (subjectSC s) u0); contradiction || trivial.",
                        "VernacExtend",
                        "a3265b3a6b0d395769a6da6270b7f7c7099e59b1"
                    ]
                },
                {
                    "command": [
                        "tauto.",
                        "VernacExtend",
                        "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
                    ]
                },
                {
                    "command": [
                        "unfold MACSecureState in MAC; apply MAC.",
                        "VernacExtend",
                        "7001554d3568352095d772c7b7be3064c2fc36d7"
                    ]
                },
                {
                    "command": [
                        "apply Close_smCorr2; auto.",
                        "VernacExtend",
                        "0005fad0d578d6677cde53a155fa9f1eba14b6a0"
                    ]
                },
                {
                    "command": [
                        "replace (fsecmat (close_sm s Sub o) o0) with (fsecmat (secmat s) o0).",
                        "VernacExtend",
                        "3d26eceb1266e91b3b1410aa8a56c3f771e1b346"
                    ]
                },
                {
                    "command": [
                        "unfold MACSecureState in MAC; apply MAC.",
                        "VernacExtend",
                        "7001554d3568352095d772c7b7be3064c2fc36d7"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "ClosePSP",
            "line_nb": 48,
            "steps": [
                {
                    "command": [
                        "intros s t Sub FP5 SP TF; inversion TF.",
                        "VernacExtend",
                        "c66de50a982c55604fe6bbc9b5f256b0e5c505c6"
                    ]
                },
                {
                    "command": [
                        "inversion H.",
                        "VernacExtend",
                        "ee20838bdd77512b43142d655a3924bf07bffebb"
                    ]
                },
                {
                    "command": [
                        "unfold StarProperty in |- *; simpl in |- *; intros.",
                        "VernacExtend",
                        "e8be7ca5cde24677c8250848fb8f09cdf9d2bb29"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (secmat s) o1, fsecmat (secmat s) o2, fOSC (objectSC s) o2, fOSC (objectSC s) o1 with | None, _, _, _ => True | _, None, _, _ => True | _, _, None, _ => True | _, _, _, None => True | Some w, Some x, Some y, Some z => set_In u0 (ActWriters w) -> set_In u0 (ActReaders x) -> le_sc y z end.",
                        "VernacExtend",
                        "976496c2502e75806a722953eaffb4df0dd0e977"
                    ]
                },
                {
                    "command": [
                        "cut match fsecmat (close_sm s Sub o) o, fsecmat (secmat s) o with | _, None => False | None, Some z => True | Some y, Some z => (set_In u0 (ActReaders y) -> set_In u0 (ActReaders z)) /\\ (set_In u0 (ActWriters y) -> set_In u0 (ActWriters z)) end.",
                        "VernacExtend",
                        "27bcf7dd914c8fa1e30e38edc799bcf67b76d688"
                    ]
                },
                {
                    "command": [
                        "elim (OBJeq_dec o o1); elim (OBJeq_dec o o2); intros EQ2 EQ1.",
                        "VernacExtend",
                        "556b2bdc98752f2a8b669378f0a11d00966187f8"
                    ]
                },
                {
                    "command": [
                        "rewrite <- EQ1; rewrite <- EQ2.",
                        "VernacExtend",
                        "fd41ba1eb2825b98b8dfd2197d0b80dc285f159e"
                    ]
                },
                {
                    "command": [
                        "elim (fsecmat (secmat s) o); elim (fOSC (objectSC s) o); elim (fsecmat (close_sm s Sub o) o); intros; auto.",
                        "VernacExtend",
                        "6d7520596d7ce61c19c678db17bd95df5feb9502"
                    ]
                },
                {
                    "command": [
                        "replace (fsecmat (close_sm s Sub o) o2) with (fsecmat (secmat s) o2).",
                        "VernacExtend",
                        "947ceab186fbc23b1909b5bc85ff4aff8dd45277"
                    ]
                },
                {
                    "command": [
                        "rewrite <- EQ1.",
                        "VernacExtend",
                        "b92e83c4536bd262dd6320d59eb18e271ed9d40d"
                    ]
                },
                {
                    "command": [
                        "elim (fsecmat (secmat s) o2); elim (fOSC (objectSC s) o); elim (fOSC (objectSC s) o2); elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o); intros; contradiction || auto.",
                        "VernacExtend",
                        "1af233ced5fc0de88be137a49cf6373343448b75"
                    ]
                },
                {
                    "command": [
                        "tauto.",
                        "VernacExtend",
                        "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "replace (fsecmat (close_sm s Sub o) o1) with (fsecmat (secmat s) o1).",
                        "VernacExtend",
                        "87eb8bb2a7fa533a96e0ac5baf9f4f7e6751e2bf"
                    ]
                },
                {
                    "command": [
                        "rewrite <- EQ2.",
                        "VernacExtend",
                        "681d28912b80a73973932919e02efd4f68e2a471"
                    ]
                },
                {
                    "command": [
                        "elim (fsecmat (secmat s) o1); elim (fOSC (objectSC s) o); elim (fOSC (objectSC s) o1); elim (fsecmat (secmat s) o); elim (fsecmat (close_sm s Sub o) o); intros; contradiction || auto.",
                        "VernacExtend",
                        "180d35843f8aefb9e3f6f6d21855e6ab23007303"
                    ]
                },
                {
                    "command": [
                        "tauto.",
                        "VernacExtend",
                        "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "replace (fsecmat (close_sm s Sub o) o2) with (fsecmat (secmat s) o2).",
                        "VernacExtend",
                        "947ceab186fbc23b1909b5bc85ff4aff8dd45277"
                    ]
                },
                {
                    "command": [
                        "replace (fsecmat (close_sm s Sub o) o1) with (fsecmat (secmat s) o1).",
                        "VernacExtend",
                        "87eb8bb2a7fa533a96e0ac5baf9f4f7e6751e2bf"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "auto.",
                        "VernacExtend",
                        "1f09da0addd069b3b65326f8c71967acc1e985af"
                    ]
                },
                {
                    "command": [
                        "apply Close_smCorr2; auto.",
                        "VernacExtend",
                        "0005fad0d578d6677cde53a155fa9f1eba14b6a0"
                    ]
                },
                {
                    "command": [
                        "unfold StarProperty in SP; apply SP.",
                        "VernacExtend",
                        "0b3038e16767bc624e3452c2ae802c795e89ae12"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        },
        {
            "name": "ClosePCP",
            "line_nb": 75,
            "steps": [
                {
                    "command": [
                        "intros; unfold PreservesControlProp in |- *; intros Sub TF; inversion TF; unfold ControlProperty in |- *.",
                        "VernacExtend",
                        "cb89a7246511afaf66c06dd1c902bc1192b4f982"
                    ]
                },
                {
                    "command": [
                        "inversion H.",
                        "VernacExtend",
                        "ee20838bdd77512b43142d655a3924bf07bffebb"
                    ]
                },
                {
                    "command": [
                        "split.",
                        "VernacExtend",
                        "55abc140132bd88981001ac656020469a8d503eb"
                    ]
                },
                {
                    "command": [
                        "intros.",
                        "VernacExtend",
                        "1b4df911c5412d25278e46f48402870ba987996b"
                    ]
                },
                {
                    "command": [
                        "split.",
                        "VernacExtend",
                        "55abc140132bd88981001ac656020469a8d503eb"
                    ]
                },
                {
                    "command": [
                        "intros; absurd (DACCtrlAttrHaveChanged s (mkSFS (groups s) (primaryGrp s) (subjectSC s) (AllGrp s) (RootGrp s) (SecAdmGrp s) (objectSC s) (acl s) (close_sm s Sub o) (files s) (directories s)) o0); auto.",
                        "VernacExtend",
                        "48e87aead00feef80c85037ee8a67342e9d84d7b"
                    ]
                },
                {
                    "command": [
                        "intros; absurd (MACObjCtrlAttrHaveChanged s (mkSFS (groups s) (primaryGrp s) (subjectSC s) (AllGrp s) (RootGrp s) (SecAdmGrp s) (objectSC s) (acl s) (close_sm s Sub o) (files s) (directories s)) o0); auto.",
                        "VernacExtend",
                        "55a717e398e94791656ca14e33a4175f4847f361"
                    ]
                },
                {
                    "command": [
                        "intros; absurd (MACSubCtrlAttrHaveChanged s (mkSFS (groups s) (primaryGrp s) (subjectSC s) (AllGrp s) (RootGrp s) (SecAdmGrp s) (objectSC s) (acl s) (close_sm s Sub o) (files s) (directories s)) u0); auto.",
                        "VernacExtend",
                        "b76c71c405ac8275c7c35d11c4f66db6aec09296"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        }
    ]
}