{
    "filename": "invprel5.v",
    "coq_project": "otway-rees",
    "vernac_cmds": [
        [
            "Require Import securite.",
            "VernacRequire",
            "79f028bb1437551f02489992d37fa72b1c6f2e29"
        ],
        [
            "Lemma POinvprel5 : forall (l l0 : list C) (k k0 k1 k2 : K) (c c0 c1 c2 : C) (d d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 d10 d11 d12 d13 d14 d15 d16 d17 d18 d19 d20 : D), inv0 (ABSI (MBNaKab d7 d8 d9 k0) (MANbKabCaCb d4 d5 d6 k c c0) (MABNaNbKeyK d d0 d1 d2 d3) l) -> inv1 (ABSI (MBNaKab d7 d8 d9 k0) (MANbKabCaCb d4 d5 d6 k c c0) (MABNaNbKeyK d d0 d1 d2 d3) l) -> invP (ABSI (MBNaKab d7 d8 d9 k0) (MANbKabCaCb d4 d5 d6 k c c0) (MABNaNbKeyK d d0 d1 d2 d3) l) -> rel5 (ABSI (MBNaKab d7 d8 d9 k0) (MANbKabCaCb d4 d5 d6 k c c0) (MABNaNbKeyK d d0 d1 d2 d3) l) (ABSI (MBNaKab d18 d19 d20 k2) (MANbKabCaCb d15 d16 d17 k1 c1 c2) (MABNaNbKeyK d10 d11 d12 d13 d14) l0) -> invP (ABSI (MBNaKab d18 d19 d20 k2) (MANbKabCaCb d15 d16 d17 k1 c1 c2) (MABNaNbKeyK d10 d11 d12 d13 d14) l0).",
            "VernacStartTheoremProof",
            "911c6561f70eaae8f3f56205fbf18f38ecb8b4e8"
        ],
        [
            "do 32 intro.",
            "VernacExtend",
            "39710ad74ca200107f422220c09716edee522c35"
        ],
        [
            "unfold inv1, invP, rel5 in |- *.",
            "VernacExtend",
            "60b58c829cda153fc771ce7d623bf9cdc9b5b73e"
        ],
        [
            "intros Inv0 know_Kas_Kbs know_Kab and1.",
            "VernacExtend",
            "9d13863d8c39bff9ff37fe2c5babe7857a36ebf0"
        ],
        [
            "elim know_Kas_Kbs; intros know_Kas know_Kbs.",
            "VernacExtend",
            "f3ef72cd49209e2900a923c97f06d70619b1b37d"
        ],
        [
            "elim and1; intros eq_l0 t1.",
            "VernacExtend",
            "9c167a5f86d7c99595f8b61704a2f2599d875dc3"
        ],
        [
            "clear Inv0 know_Kas_Kbs and1 t1.",
            "VernacExtend",
            "1508311ef74bf1522345d79dcba8369cf402e20f"
        ],
        [
            "rewrite eq_l0.",
            "VernacExtend",
            "e7f54cf2b5676aaa2d717b61f80f830328812a52"
        ],
        [
            "unfold triple in |- *.",
            "VernacExtend",
            "5064e5a0cbde428e2a6e1078274978e722072e35"
        ],
        [
            "apply D2.",
            "VernacExtend",
            "9594f7b31e8422866c2cf6cabaf3749915c39f61"
        ],
        [
            "simpl in |- *.",
            "VernacExtend",
            "1b93169f4cf876d207c1fab22a2347202ab48d85"
        ],
        [
            "repeat apply C3 || apply C4.",
            "VernacExtend",
            "a155ad99c01b140b954eae6986d0af6f4a00bc69"
        ],
        [
            "elim (D_dec d0 d1).",
            "VernacExtend",
            "55759043c211cee479bd32a3a87b02fee29765d2"
        ],
        [
            "intros eq_d0_d1; elim eq_d0_d1; intros eq_d0 eq_d1.",
            "VernacExtend",
            "2ae2b183a00aa0e516000500f6705c34e6fda795"
        ],
        [
            "rewrite eq_d0.",
            "VernacExtend",
            "4126b0b994e791611187d9d9ffbc2b26d675ad4d"
        ],
        [
            "rewrite eq_d1.",
            "VernacExtend",
            "2414e8419998fd207f111ebcc31dceb20e31531b"
        ],
        [
            "apply C1.",
            "VernacExtend",
            "d4e3496a04a95a8a66362aa1ded4476faa8cb7f6"
        ],
        [
            "apply C1.",
            "VernacExtend",
            "d4e3496a04a95a8a66362aa1ded4476faa8cb7f6"
        ],
        [
            "apply D1.",
            "VernacExtend",
            "3e1fa6fecd4cb6443f8b5a93083977de2a8a4512"
        ],
        [
            "apply EP1 with rngDDKKeyAB.",
            "VernacExtend",
            "992b43eb5f91fa31cdbd3369508be604f9825aed"
        ],
        [
            "apply equivnknown1 with (B2C (K2B (KeyX Bid))) (l ++ rngDDKKeyAB).",
            "VernacExtend",
            "d7afc75df60ae963e052e150a5e170c9e93fae9a"
        ],
        [
            "apply equivS4 with (l ++ rngDDKKeyABminusKab ++ rngDDKKeyAB).",
            "VernacExtend",
            "58cb898c0d39e117c3eff884b367fcc9fc13032f"
        ],
        [
            "elim l; simpl in |- *; auto with otway_rees.",
            "VernacExtend",
            "7828e5454bba024ab1328520141301bd8772987f"
        ],
        [
            "exact rngs.",
            "VernacExtend",
            "7cc1a5fd26499e11be8282f371051e69371fc62d"
        ],
        [
            "rewrite (app_ass l rngDDKKeyABminusKab rngDDKKeyAB).",
            "VernacExtend",
            "317956082df85f93b272aea0c27bd3b1c03f3b6d"
        ],
        [
            "elim l; elim rngDDKKeyABminusKab; elim rngDDKKeyAB; simpl in |- *; auto with otway_rees.",
            "VernacExtend",
            "43c86592ec23d9d7ade85949e6cc0be76f71483d"
        ],
        [
            "auto with otway_rees.",
            "VernacExtend",
            "a60f8dc39dc8229fa4ec95c1b243a730d085e56b"
        ],
        [
            "assumption.",
            "VernacExtend",
            "41f0308313ff87e6ab2782f90d6021ec4b55d932"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "intros not_eq_d0_d1.",
            "VernacExtend",
            "84dbe0162e06915ac13a7b7e4745ed393c18af39"
        ],
        [
            "repeat apply C2 || apply C3 || apply C4.",
            "VernacExtend",
            "f83b07d1e85b13662406591fda67be2523a6a6ef"
        ],
        [
            "apply equivncomp with (Encrypt (Pair (B2C (D2B d3)) (B2C (K2B (KeyAB d0 d1)))) (KeyX d1) :: B2C (K2B (KeyAB d0 d1)) :: l ++ rngDDKKeyABminusKab).",
            "VernacExtend",
            "be9aebd7545d2feb710618072b881dc7e95cb65d"
        ],
        [
            "apply equivS2.",
            "VernacExtend",
            "2cfdcb5fb3fc54f0b168e84d917e3b2be6ad17c1"
        ],
        [
            "repeat apply C2 || apply C3 || apply C4.",
            "VernacExtend",
            "f83b07d1e85b13662406591fda67be2523a6a6ef"
        ],
        [
            "apply equivncomp with (B2C (K2B (KeyAB d0 d1)) :: l ++ rngDDKKeyABminusKab).",
            "VernacExtend",
            "59bd27111628d862f4ecdc620916655e91df0146"
        ],
        [
            "apply AlreadyIn1; unfold In in |- *; left; auto with otway_rees.",
            "VernacExtend",
            "06f82af57ad06a8e849cf14e2cc64e39e27a2cd0"
        ],
        [
            "apply equivncomp with (l ++ rngDDKKeyABminusKab).",
            "VernacExtend",
            "38b5bd0007f3c3e631f13357a7412d5647f8c471"
        ],
        [
            "apply AlreadyIn1; apply in_or_app; right.",
            "VernacExtend",
            "19aa59ab159013b01f45def2c5d993a42f9051b3"
        ],
        [
            "apply rngDDKKeyABminusKab1; apply KeyAB1.",
            "VernacExtend",
            "55f509102aa301092a185e6a3d52bb362e92e153"
        ],
        [
            "tauto.",
            "VernacExtend",
            "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
        ],
        [
            "apply D1; assumption.",
            "VernacExtend",
            "f827019a0240ff77a753d85d52d1fe547593105e"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "discriminate.",
            "VernacExtend",
            "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
        ],
        [
            "Qed.",
            "VernacEndProof",
            "6eee6c55dea8e22a11abc36404343a43e520a888"
        ]
    ],
    "proofs": [
        {
            "name": "POinvprel5",
            "line_nb": 1,
            "steps": [
                {
                    "command": [
                        "do 32 intro.",
                        "VernacExtend",
                        "39710ad74ca200107f422220c09716edee522c35"
                    ]
                },
                {
                    "command": [
                        "unfold inv1, invP, rel5 in |- *.",
                        "VernacExtend",
                        "60b58c829cda153fc771ce7d623bf9cdc9b5b73e"
                    ]
                },
                {
                    "command": [
                        "intros Inv0 know_Kas_Kbs know_Kab and1.",
                        "VernacExtend",
                        "9d13863d8c39bff9ff37fe2c5babe7857a36ebf0"
                    ]
                },
                {
                    "command": [
                        "elim know_Kas_Kbs; intros know_Kas know_Kbs.",
                        "VernacExtend",
                        "f3ef72cd49209e2900a923c97f06d70619b1b37d"
                    ]
                },
                {
                    "command": [
                        "elim and1; intros eq_l0 t1.",
                        "VernacExtend",
                        "9c167a5f86d7c99595f8b61704a2f2599d875dc3"
                    ]
                },
                {
                    "command": [
                        "clear Inv0 know_Kas_Kbs and1 t1.",
                        "VernacExtend",
                        "1508311ef74bf1522345d79dcba8369cf402e20f"
                    ]
                },
                {
                    "command": [
                        "rewrite eq_l0.",
                        "VernacExtend",
                        "e7f54cf2b5676aaa2d717b61f80f830328812a52"
                    ]
                },
                {
                    "command": [
                        "unfold triple in |- *.",
                        "VernacExtend",
                        "5064e5a0cbde428e2a6e1078274978e722072e35"
                    ]
                },
                {
                    "command": [
                        "apply D2.",
                        "VernacExtend",
                        "9594f7b31e8422866c2cf6cabaf3749915c39f61"
                    ]
                },
                {
                    "command": [
                        "simpl in |- *.",
                        "VernacExtend",
                        "1b93169f4cf876d207c1fab22a2347202ab48d85"
                    ]
                },
                {
                    "command": [
                        "repeat apply C3 || apply C4.",
                        "VernacExtend",
                        "a155ad99c01b140b954eae6986d0af6f4a00bc69"
                    ]
                },
                {
                    "command": [
                        "elim (D_dec d0 d1).",
                        "VernacExtend",
                        "55759043c211cee479bd32a3a87b02fee29765d2"
                    ]
                },
                {
                    "command": [
                        "intros eq_d0_d1; elim eq_d0_d1; intros eq_d0 eq_d1.",
                        "VernacExtend",
                        "2ae2b183a00aa0e516000500f6705c34e6fda795"
                    ]
                },
                {
                    "command": [
                        "rewrite eq_d0.",
                        "VernacExtend",
                        "4126b0b994e791611187d9d9ffbc2b26d675ad4d"
                    ]
                },
                {
                    "command": [
                        "rewrite eq_d1.",
                        "VernacExtend",
                        "2414e8419998fd207f111ebcc31dceb20e31531b"
                    ]
                },
                {
                    "command": [
                        "apply C1.",
                        "VernacExtend",
                        "d4e3496a04a95a8a66362aa1ded4476faa8cb7f6"
                    ]
                },
                {
                    "command": [
                        "apply C1.",
                        "VernacExtend",
                        "d4e3496a04a95a8a66362aa1ded4476faa8cb7f6"
                    ]
                },
                {
                    "command": [
                        "apply D1.",
                        "VernacExtend",
                        "3e1fa6fecd4cb6443f8b5a93083977de2a8a4512"
                    ]
                },
                {
                    "command": [
                        "apply EP1 with rngDDKKeyAB.",
                        "VernacExtend",
                        "992b43eb5f91fa31cdbd3369508be604f9825aed"
                    ]
                },
                {
                    "command": [
                        "apply equivnknown1 with (B2C (K2B (KeyX Bid))) (l ++ rngDDKKeyAB).",
                        "VernacExtend",
                        "d7afc75df60ae963e052e150a5e170c9e93fae9a"
                    ]
                },
                {
                    "command": [
                        "apply equivS4 with (l ++ rngDDKKeyABminusKab ++ rngDDKKeyAB).",
                        "VernacExtend",
                        "58cb898c0d39e117c3eff884b367fcc9fc13032f"
                    ]
                },
                {
                    "command": [
                        "elim l; simpl in |- *; auto with otway_rees.",
                        "VernacExtend",
                        "7828e5454bba024ab1328520141301bd8772987f"
                    ]
                },
                {
                    "command": [
                        "exact rngs.",
                        "VernacExtend",
                        "7cc1a5fd26499e11be8282f371051e69371fc62d"
                    ]
                },
                {
                    "command": [
                        "rewrite (app_ass l rngDDKKeyABminusKab rngDDKKeyAB).",
                        "VernacExtend",
                        "317956082df85f93b272aea0c27bd3b1c03f3b6d"
                    ]
                },
                {
                    "command": [
                        "elim l; elim rngDDKKeyABminusKab; elim rngDDKKeyAB; simpl in |- *; auto with otway_rees.",
                        "VernacExtend",
                        "43c86592ec23d9d7ade85949e6cc0be76f71483d"
                    ]
                },
                {
                    "command": [
                        "auto with otway_rees.",
                        "VernacExtend",
                        "a60f8dc39dc8229fa4ec95c1b243a730d085e56b"
                    ]
                },
                {
                    "command": [
                        "assumption.",
                        "VernacExtend",
                        "41f0308313ff87e6ab2782f90d6021ec4b55d932"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "intros not_eq_d0_d1.",
                        "VernacExtend",
                        "84dbe0162e06915ac13a7b7e4745ed393c18af39"
                    ]
                },
                {
                    "command": [
                        "repeat apply C2 || apply C3 || apply C4.",
                        "VernacExtend",
                        "f83b07d1e85b13662406591fda67be2523a6a6ef"
                    ]
                },
                {
                    "command": [
                        "apply equivncomp with (Encrypt (Pair (B2C (D2B d3)) (B2C (K2B (KeyAB d0 d1)))) (KeyX d1) :: B2C (K2B (KeyAB d0 d1)) :: l ++ rngDDKKeyABminusKab).",
                        "VernacExtend",
                        "be9aebd7545d2feb710618072b881dc7e95cb65d"
                    ]
                },
                {
                    "command": [
                        "apply equivS2.",
                        "VernacExtend",
                        "2cfdcb5fb3fc54f0b168e84d917e3b2be6ad17c1"
                    ]
                },
                {
                    "command": [
                        "repeat apply C2 || apply C3 || apply C4.",
                        "VernacExtend",
                        "f83b07d1e85b13662406591fda67be2523a6a6ef"
                    ]
                },
                {
                    "command": [
                        "apply equivncomp with (B2C (K2B (KeyAB d0 d1)) :: l ++ rngDDKKeyABminusKab).",
                        "VernacExtend",
                        "59bd27111628d862f4ecdc620916655e91df0146"
                    ]
                },
                {
                    "command": [
                        "apply AlreadyIn1; unfold In in |- *; left; auto with otway_rees.",
                        "VernacExtend",
                        "06f82af57ad06a8e849cf14e2cc64e39e27a2cd0"
                    ]
                },
                {
                    "command": [
                        "apply equivncomp with (l ++ rngDDKKeyABminusKab).",
                        "VernacExtend",
                        "38b5bd0007f3c3e631f13357a7412d5647f8c471"
                    ]
                },
                {
                    "command": [
                        "apply AlreadyIn1; apply in_or_app; right.",
                        "VernacExtend",
                        "19aa59ab159013b01f45def2c5d993a42f9051b3"
                    ]
                },
                {
                    "command": [
                        "apply rngDDKKeyABminusKab1; apply KeyAB1.",
                        "VernacExtend",
                        "55f509102aa301092a185e6a3d52bb362e92e153"
                    ]
                },
                {
                    "command": [
                        "tauto.",
                        "VernacExtend",
                        "9bfafe84fb6724789bdf6cfd21cd721dd63fdabd"
                    ]
                },
                {
                    "command": [
                        "apply D1; assumption.",
                        "VernacExtend",
                        "f827019a0240ff77a753d85d52d1fe547593105e"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "discriminate.",
                        "VernacExtend",
                        "66ca81b65e1a53372a2515fdfdd2a6b0677cb9c8"
                    ]
                },
                {
                    "command": [
                        "Qed.",
                        "VernacEndProof",
                        "6eee6c55dea8e22a11abc36404343a43e520a888"
                    ]
                }
            ]
        }
    ]
}